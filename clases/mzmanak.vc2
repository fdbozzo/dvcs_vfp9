*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="mzmanak.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS cmcerrar AS commandbutton 
 	*< CLASSDATA: Baseclass="commandbutton" Timestamp="" Scale="Pixels" Uniqueid="" />

	Caption = ""
	DisabledPicture = ..\graphics\cerrar114cuan.bmp
	Height = 25
	Name = "cmcerrar"
	Picture = ..\graphics\cerrar114cua.bmp
	Width = 26
	
	PROCEDURE Click
		Thisform.Release
		
	ENDPROC

ENDDEFINE

DEFINE CLASS cmprintform AS commandbutton 
 	*< CLASSDATA: Baseclass="commandbutton" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*m: printcnz
		*m: printform
		*p: nmat
		*a: gatop[1,0]
		*a: gavisib[1,0]
	*</DefinedPropArrayMethod>

	Caption = ""
	DisabledPicture = ..\graphics\impre232n.bmp
	Height = 25
	Name = "cmprintform"
	nmat = 1
	Picture = ..\graphics\impre232.bmp
	ToolTipText = "Imprimir Contenido Formulario"
	Width = 30
	
	PROCEDURE Click
		This.printform(thisform)
		
	ENDPROC

	PROCEDURE GotFocus
		Thisform.FunManak1.putraya(this)
	ENDPROC

	PROCEDURE Init
		STORE null TO this.gavisib
		
	ENDPROC

	PROCEDURE LostFocus
		Thisform.FunManak1.putraya()
	ENDPROC

	PROCEDURE printcnz
		LPARAMETERS xoObjeto,xlOmitDef
		***************************************
		* PROCEDURE PrintCnt(xoObjeto,xlomitDef)
		***************************************
		
		
		LOCAL ocontrol,opage,lnTop,lnLeft,lnWidth,;
			lctexto,lnNumero,ldFEcha,ltFecha,lmat,lcSalto,LcMask
			
		lcSalto="IMAGE,SHAPE,LINE,COMMANDBUTTON,COMMANDGROUP,";
			+"LIST,OPTIONGROUP,TIMER,OLECONTROL,";
			+"OLEBOUNDCONTROL,HYPERLINK,CUSTOM,"
		lcMask=""
		
		lcBaseClass=UPPER(xoObjeto.BaseClass)
		
		DO CASE
			CASE AT(lcBaseClass,lcSalto)#0
			
			CASE lcBaseClass=="FORM"
				FOR EACH ocontrol IN xoObjeto.controls
					This.printCnz(ocontrol,.t.)
				ENDFOR
		*	CASE INLIST(lcBaseClass,"CONTAINER")
			CASE lcBaseClass=="CONTAINER"
				IF xoObjeto.Visible
					FOR EACH ocontrol IN xoObjeto.controls
						This.printCnz(ocontrol,.t.)
					ENDFOR	
				ENDIF
				
		*	CASE INLIST(lcBaseClass,"PAGEFRAME")
		*	CASE lcBaseClass=="PAGEFRAME"
			CASE LCBASECLASS=="PAGEFRAME"
				IF xoObjeto.visible
					FOR EACH ocontrol IN xoObjeto.Pages
						this.PrintCnz(oPage,.t.)
					ENDFOR	
				ENDIF
		
		*	CASE INLIST(lcBaseClass,"PAGE")
			CASE lcBaseClass=="PAGE"
				IF xoObjeto.visible
					FOR EACH opage IN xoObjeto.Controls
						this.PrintCnz(oPage,.t.)
					ENDFOR	
				ENDIF		
		
			OTHERWISE
				IF xoObjeto.Visible
				
		*			lbTop=OBJTOCLIENT(xoObjeto,1)
		*			lnTop=FLOOR((xoObjeto.top+3)/20)*20
					lnTop=FLOOR((OBJTOCLIENT(xoObjeto,1)+3)/20)*20
					lmat=.t.
					FOR j=1 TO ALEN(this.gatop)
						IF ABS(lnTop-this.gatop[j])<18
							lnTop=this.gatop[j]
		
							lmat=.f.
							exit
						ENDIF
					NEXT
					IF lmat
						this.nmat=this.nmat+1
						DIMENSION this.gatop(this.nmat)
						this.gatop[this.nmat]=lntop
					ENDIF
			
			
		*			lnleft=xoObjeto.Left
					lnLeft=OBJTOCLIENT(xoObjeto,2)
					lnWidth=xoObjeto.Width
					lcTexto=""
					ldFecha=CTOD("")
					ltFecha=ldfecha
			
					lnNumero=0
					lPrint=.t.
		
					DO case
						CASE lcBaseClass=="LABEL"
							lcTexto=ALLTRIM(xoObjeto.caption)
		
						CASE LcBaseClass=="TEXTBOX"
							lcVart=VARTYPE(xoObjeto.Value)
							DO case
								CASE lcVart="D"
									ldFecha=xoObjeto.value
								CASE lcVart="T"
									ltFEcha=xoObjeto.value
								CASE lcVart="N"
									lnNumero=xoObjeto.value	
									lcMask=xoObjeto.InputMask	
									IF EMPTY(LCMASK)
										ndec=thisform.FunManak1.teldecim(lnNumero)
										lcMask=thisform.FunManak1.detmask(lnNumero,ndec)
									ENDIF
											
								OTHERWISE
									lcTExto=TRIM(xoObjeto.Value)
							ENDCASE
		
						CASE lcBaseClass=="SPINNER"
							lnNumero=xoObjeto.value
							lcMask=xoObjeto.InputMask	
							IF EMPTY(LCMASK)
								ndec=thisform.FunManak1.teldecim(lnNumero)
								lcMask=thisform.FunManak1.detmask(lnNumero,ndec)
							ENDIF
						CASE lcbaseclass="EDITBOX"
							lcTexto=thisform.funmanak1.Qualifer2(xoObjeto.TEXT,,"")
						CASE lcBaseClass=="CHECKBOX"
		
							lcTExto=ALLTRIM(xoObjeto.Caption)+" "+thisform.funmanak1.Qualifer2(xoObjeto.Value,,"")
						CASE lcBaseClass=="COMBOBOX"
							LcTexto=ALLTRIM(xoObjeto.DisplayValue)
						
					ENDCASE
					INSERT INTO saprint (ntop,nleft,nwidth,Texto,Numero,fecha,fechall,cControl,trutop,MARGEN,maskara) ;
						VALUES (lnTop,lnLeft,lnWidth,lcTexto,lnNumero,ldFecha,ltFecha,xoObjeto.name,xoObjeto.top,ROUND(lnLeft/5.36,0),lcMask)
				ENDIF
				
		ENDCASE
		
		
	ENDPROC

	PROCEDURE printform
		LPARAMETERS xoObjeto
		LOCAL fcr,nfop,i,o,lnMIn,lcCaption,ni,lnPad,nmAcum,lcAdd,lcText,;
			nDivide,lnVisible,lnRepli
		lnvisible=0
		FOR i=1 TO ALEN(this.gavisib,1)
			IF !ISNULL(this.gavisib[i,1])
				this.gavisib[i,2]=this.gavisib[i,1].visible
				this.gavisib[i,1].visible=.f.
				lnvisible=lnvisible+1
			ENDIF
		NEXT
		
		nDivide=6.5
		IF UPPER(xoObjeto.baseclass)=="FORM"
			lcCaption=ALLTRIM(xoObjeto.Caption)
		ENDIF
		fcr=ADDBS(fullpath(""))+"saprint.txt"
		IF FILE(fcr)
			DELETE FILE &fcr
		ENDIF
		IF USED("SAPRINT")
			SELECT SAPRINT
			USE
		ENDIF
		
		
		create CURSOR saprint ;
			("ntop" I,"nleft" I,"NWIDTH" I,"TEXTO" M,"NUMERO" N(14,2),"FECHA" D, "FECHALL" T,;
			"CCONTROL" C(40),"trutop" i,"MARGEN" I,;
			"MASKARA" C(40))
			
		
		DIMENSION This.gatop(1)
		this.gatop[1]=0
		this.nmat=1
		
		this.Printcnz(xoObjeto,.f.)
		
		SELECT saprint
		GO top
		IF EOF()
			USE
			MESSAGEBOX("No se generó el informe")
			RETURN .f.
		ENDIF
		INDEX on STR(ntop,4)+STR(nleft,4) TAG isaprint
		GO top
		LOCAL ARRAY gamat(1,2)
		gamat[1,1]=0
		gamat[1,2]=""
		ni=1
		lnMin=99999
		SELECT saprint
		SCAN
			IF margen<lnMin
				lnMIn=margen
			ENDIF
				IF ASCAN(gamat,ntop)=0
				ni=ni+1
				DIMENSION gamat(ni,2)
				gamat[ni,1]=ntop
				gamat[ni,2]=""
			ENDIF
		ENDSCAN
		FOR i=1 TO ALEN(gamat,1)
			lcText=""
			np=gamat[i,1]
			SELECT saprint
			SCAN FOR ntop=np
				lcAdd=""
				nmAcum=0
				DO case
					CASE !EMPTY(texto)
						lcAdd=ALLTRIM(texto)
					CASE !EMPTY(numero)
						
						lcMask=ALLTRIM(maskara)
						IF EMPTY(lcMask)
							lcAdd=PADL(TRANSFORM(numero,GetMask(Numero)),INT(nWidth/nDivide)+1)
						ELSE
							lcAdd=PADL(LTRIM(TRANSFORM(numero,lcMask)),INT(nWidth/nDivide)+1)
						ENDIF
						
					CASE !EMPTY(fecha)
						lcAdd=DTOC(fecha)
					CASE !EMPTY(fechall)
						lcAdd=TTOC(fecha)
				ENDCASE
				lnPad=Margen-nmAcum
				nmAcum=nmacum+Margen
				lcText=PADr(lcText,nmAcum," ")+IIF(EMPTY(lcText),""," ")+lcAdd
			ENDSCAN
			gamat[i,2]=lcText
		NEXT
		SELECT SAPRINT
		USE
		
		
		
		lnRepli=0
		FOR i=1 TO ALEN(gamat,1)
			lnRepli=MAX(lnRepli,LEN(gamat[i,2]))
		NEXT
		lnRepli=lnRepli+3
		nfop=FCREATE(fcr)
		=FPUTS(nfop,REPLICATE("—",lnRepli))
		IF !EMPTY(lcCaption)
			=FPUTS(NFOP,SPACE(lnMIn)+lcCaption)
			=FPUTS(nfop,REPLICATE("—",lnRepli))
		ENDIF
		FOR i=1 TO ALEN(gamat,1)
			=FPUTS(nfop," "+gamat[i,2])
		NEXT
		=FPUTS(nfop,REPLICATE("—",lnRepli))
		FCLOSE(nfop)
		IF FILE(fcr)
			o = CREATEOBJECT("Shell.Application")
			o.ShellExecute("notepad.exe", '&fcr', "", "open", 1)
		ENDIF
		IF lnVisible#0
			FOR i=1 TO ALEN(this.gavisib,1)
				IF !ISNULL(this.gavisib[i,1])
					
					this.gavisib[i,1].visible=this.gavisib[i,2]
				ENDIF
			NEXT
		ENDIF
		
		RETURN
		
	ENDPROC

ENDDEFINE

DEFINE CLASS cntalma AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shape3d1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text28" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text29" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text30" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text31" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text32" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text33" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text34" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text35" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text36" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text37" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text38" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text39" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text40" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text41" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text42" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.Edit1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.TxFecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container1.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container2.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container3.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container4.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container5.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container6.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Container7.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape3d2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Spinner2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Combo1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CmCalc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmprintform1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmgMeses" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cnthoy1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: binddbl
		*m: bindfo
		*m: bindgo
		*m: bindlost
		*m: gmes
		*m: thcentrar
		*p: ano
		*p: dbcolor
		*p: dia
		*p: fechasel
		*p: focolor
		*p: masdias
		*p: mes
		*p: selmes
		*p: selperi
		*a: adiasem[7,0]		&& Dias de la semana
		*a: zenmes[12,0]		&& matriz de meses
	*</DefinedPropArrayMethod>

	ano = .F.
	BackStyle = 0
	BorderWidth = 0
	dbcolor = .F.
	dia = .F.
	fechasel = .F.
	focolor = .F.
	Height = 208
	masdias = 30
	mes = .F.
	Name = "cntalma"
	selmes = .F.
	selperi = .F.
	Width = 333

	ADD OBJECT 'CmCalc' AS commandbutton WITH ;
		Caption = "", ;
		Height = 24, ;
		Left = 208, ;
		Name = "CmCalc", ;
		Picture = ..\graphics\calcula2.bmp, ;
		ToolTipText = "Calcular tiempos", ;
		Top = 3, ;
		Width = 29
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmgMeses' AS commandgroup WITH ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 17, ;
		Left = 160, ;
		Name = "cmgMeses", ;
		Top = 6, ;
		Value = 1, ;
		Width = 40, ;
		Command1.BackColor = 149,177,171, ;
		Command1.Caption = "", ;
		Command1.DisabledPicture = ..\graphics\fle1132leftgn.bmp, ;
		Command1.Height = 16, ;
		Command1.Left = 1, ;
		Command1.Name = "cmdMesAnt", ;
		Command1.Picture = ..\graphics\fle1132leftg.bmp, ;
		Command1.SpecialEffect = 1, ;
		Command1.ToolTipText = "Mes Anterior", ;
		Command1.Top = 1, ;
		Command1.Width = 19, ;
		Command2.BackColor = 149,177,171, ;
		Command2.Caption = "", ;
		Command2.DisabledPicture = ..\graphics\fle1132rigthgn.bmp, ;
		Command2.Height = 16, ;
		Command2.Left = 20, ;
		Command2.Name = "cmdMesSig", ;
		Command2.Picture = ..\graphics\fle1132rightg.bmp, ;
		Command2.SpecialEffect = 1, ;
		Command2.ToolTipText = "Mes Siguiente", ;
		Command2.Top = 1, ;
		Command2.Width = 19
		*< END OBJECT: BaseClass="commandgroup" />

	ADD OBJECT 'Cmprintform1' AS cmprintform WITH ;
		Left = 239, ;
		Name = "Cmprintform1", ;
		Top = 3
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cntfe' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 22, ;
		Left = 4, ;
		Name = "Cntfe", ;
		Top = 168, ;
		Width = 261
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'Cntfe.Edit1' AS editbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 1, ;
		Name = "Edit1", ;
		ScrollBars = 0, ;
		SpecialEffect = 1, ;
		Top = 1, ;
		Width = 198
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Cntfe.TxFecha' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "D", ;
		Height = 21, ;
		Left = 198, ;
		Name = "TxFecha", ;
		SpecialEffect = 1, ;
		Top = 1, ;
		Width = 63
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Cnthoy1' AS cnthoy WITH ;
		Left = 181, ;
		Name = "Cnthoy1", ;
		Top = 171, ;
		imgHoy.Height = 18, ;
		imgHoy.Name = "imgHoy", ;
		imgHoy.Width = 22, ;
		imgNot.Height = 18, ;
		imgNot.Name = "imgNot", ;
		imgNot.Width = 22
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="container" />

	ADD OBJECT 'CntTit' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 21, ;
		Left = 3, ;
		Name = "CntTit", ;
		Top = 33, ;
		Width = 265
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container1' AS container WITH ;
		BackColor = 255,0,0, ;
		Height = 19, ;
		Left = 1, ;
		Name = "Container1", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 38
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container1.Glab1' AS glab WITH ;
		Caption = "Dom", ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Left = 5, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Container2' AS container WITH ;
		BackColor = 73,136,160, ;
		Height = 19, ;
		Left = 39, ;
		Name = "Container2", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 37
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container2.Glab1' AS glab WITH ;
		Caption = "Lun", ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Left = 5, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Container3' AS container WITH ;
		BackColor = 73,136,160, ;
		Height = 19, ;
		Left = 76, ;
		Name = "Container3", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 37
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container3.Glab1' AS glab WITH ;
		Caption = "Mar", ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Left = 5, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Container4' AS container WITH ;
		BackColor = 73,136,160, ;
		Height = 19, ;
		Left = 113, ;
		Name = "Container4", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 37
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container4.Glab1' AS glab WITH ;
		Caption = "Mie", ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Left = 5, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Container5' AS container WITH ;
		BackColor = 73,136,160, ;
		Height = 19, ;
		Left = 150, ;
		Name = "Container5", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 37
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container5.Glab1' AS glab WITH ;
		Caption = "Jue", ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Left = 5, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Container6' AS container WITH ;
		BackColor = 73,136,160, ;
		Height = 19, ;
		Left = 187, ;
		Name = "Container6", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 37
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container6.Glab1' AS glab WITH ;
		Caption = "Vie", ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Left = 5, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Container7' AS container WITH ;
		BackColor = 1,150,199, ;
		Height = 19, ;
		Left = 224, ;
		Name = "Container7", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 38
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Container7.Glab1' AS glab WITH ;
		Caption = "Sab", ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Left = 5, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Gmarco8' AS gmarco WITH ;
		BackStyle = 0, ;
		Height = 19, ;
		Left = 1, ;
		Name = "Gmarco8", ;
		Top = 2, ;
		Visible = .F., ;
		Width = 260
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Combo1' AS combobox WITH ;
		BorderColor = 114,136,141, ;
		FontSize = 8, ;
		Height = 20, ;
		Left = 5, ;
		Name = "Combo1", ;
		SpecialEffect = 1, ;
		Style = 2, ;
		Top = 5, ;
		Width = 93
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'Gmarco1' AS gmarco WITH ;
		Height = 20, ;
		Left = 71, ;
		Name = "Gmarco1", ;
		Top = 56, ;
		Width = 259
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco2' AS gmarco WITH ;
		Height = 20, ;
		Left = 71, ;
		Name = "Gmarco2", ;
		Top = 136, ;
		Width = 260
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco3' AS gmarco WITH ;
		Height = 20, ;
		Left = 71, ;
		Name = "Gmarco3", ;
		Top = 155, ;
		Width = 260
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Shape3d1' AS shape3d WITH ;
		Height = 167, ;
		Left = 1, ;
		Name = "Shape3d1", ;
		Top = 29, ;
		Width = 269
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Shape3d2' AS shape3d WITH ;
		Height = 28, ;
		Left = 1, ;
		Name = "Shape3d2", ;
		Top = 1, ;
		Width = 205
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Spinner2' AS spinner WITH ;
		BorderColor = 114,136,141, ;
		FontSize = 8, ;
		Height = 20, ;
		KeyboardHighValue = 2050, ;
		KeyboardLowValue = 1980, ;
		Left = 97, ;
		Name = "Spinner2", ;
		SpecialEffect = 1, ;
		SpinnerHighValue = 2050.00, ;
		SpinnerLowValue = 1980.00, ;
		Top = 5, ;
		Width = 60
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'Text1' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 54, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text10' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 79, ;
		Name = "Text10", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 73, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text11' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 116, ;
		Name = "Text11", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 73, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text12' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 153, ;
		Name = "Text12", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 73, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text13' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 190, ;
		Name = "Text13", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 73, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text14' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 227, ;
		Name = "Text14", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 73, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text15' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text15", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 92, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text16' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 42, ;
		Name = "Text16", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 92, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text17' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 79, ;
		Name = "Text17", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 92, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text18' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 116, ;
		Name = "Text18", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 92, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text19' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 153, ;
		Name = "Text19", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 92, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text2' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 42, ;
		Name = "Text2", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 54, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text20' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 190, ;
		Name = "Text20", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 92, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text21' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 227, ;
		Name = "Text21", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 92, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text22' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text22", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 111, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text23' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 42, ;
		Name = "Text23", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 111, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text24' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 79, ;
		Name = "Text24", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 111, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text25' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 116, ;
		Name = "Text25", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 111, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text26' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 153, ;
		Name = "Text26", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 111, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text27' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 190, ;
		Name = "Text27", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 111, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text28' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 227, ;
		Name = "Text28", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 111, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text29' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text29", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 130, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text3' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 79, ;
		Name = "Text3", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 54, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text30' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 42, ;
		Name = "Text30", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 130, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text31' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 79, ;
		Name = "Text31", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 130, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text32' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 116, ;
		Name = "Text32", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 130, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text33' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 153, ;
		Name = "Text33", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 130, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text34' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 190, ;
		Name = "Text34", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 130, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text35' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 227, ;
		Name = "Text35", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 130, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text36' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text36", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 149, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text37' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 42, ;
		Name = "Text37", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 149, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text38' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 79, ;
		Name = "Text38", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 149, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text39' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 116, ;
		Name = "Text39", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 149, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text4' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 116, ;
		Name = "Text4", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 54, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text40' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 153, ;
		Name = "Text40", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 149, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text41' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 190, ;
		Name = "Text41", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 149, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text42' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 227, ;
		Name = "Text42", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 149, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text5' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 153, ;
		Name = "Text5", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 54, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text6' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 190, ;
		Name = "Text6", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 54, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text7' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 227, ;
		Name = "Text7", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 54, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text8' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text8", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 73, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text9' AS textbox WITH ;
		Alignment = 2, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Format = "Z", ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 42, ;
		Name = "Text9", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 73, ;
		Value = 0, ;
		Width = 38
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE binddbl
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		lnDay=obj.Value
		lcFrase=LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
		this.dia=lnDay
		_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
		
		thisform.Release
		
		
	ENDPROC

	PROCEDURE bindfo
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		WITH obj
			this.dbcolor=.Disabledbackcolor
			this.focolor=.Forecolor
			.DisabledBackColor=RGB(10,36,106)
			.ForeColor=RGB(255,255,255)
		ENDWITH
		
		lnDay=obj.Value
		this.dia=lnDay
		this.cntfe.txfecha.Value=DATE(this.ano,this.mes,this.dia)
		
		
		
	ENDPROC

	PROCEDURE bindgo
		LPARAMETERS nKeyCode, nShiftAltCtrl
		LOCAL obj,nEvents,nSalto,lcnum,lnNum
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		lcNum=CHRTRAN(obj.name,CHRTRAN(obj.Name,"1234567890",""),"")
		lnNum=VAL(lcNum)
		DO case
			CASE nKeyCode=43	&& +
				NODEFAULT
				
				IF this.mes=12
					this.mes=1
					this.ano=this.ano+1
				ELSE
					this.Mes=this.mes+1
				ENDIF
				WITH this
					.Selmes=PROPER(.ZenMes[this.mes])
					.Combo1.REfresh		
					.spinner2.refresh
		
				ENDWITH
				
				this.gmes(this.ano,this.mes,.t.)
			CASE nKeyCode=45	&& -
				NODEFAULT
				
				IF this.mes=1
					this.mes=12
					this.ano=this.ano-1
				ELSE
					this.mes=this.mes-1
				ENDIF
				WITH this
					.Selmes=PROPER(.ZenMes[this.mes])
					.Combo1.REfresh		
					.spinner2.refresh
		
				ENDWITH		
				this.gmes(this.ano,this.mes,.t.)
			CASE nKeyCode=13
				NODEFAULT
				
				lnDay=obj.Value
				lcFrase=LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
				this.dia=lnDay
				_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
		
				thisform.Release
			
			CASE nKeyCode=5		&& UpARr
				NODEFAULT
				lnNum=lnNUm-nSalto
				IF lnNum>0
					lcGo="Text"+LTRIM(STR(lnNUm))
					IF PEMSTATUS(obj.parent,lcGo,5)
						
						obj.parent.&lcGo..setfocus
					ENDIF
				ENDIF
		
		
				
			CASE nKeyCode=24	&& DnArr
				NODEFAULT
				lnNUm=lnNUm+nSalto
				lcGo="Text"+LTRIM(STR(lnNUm))
				IF PEMSTATUS(obj.parent,lcGo,5)
					
					obj.parent.&lcGo..setfocus
				ENDIF
			CASE nKeyCode=4		&& RiARr
				NODEFAULT
				lnNum=lnNum+1
				lcGo="Text"+LTRIM(STR(lnNUm))
				IF PEMSTATUS(obj.parent,lcGo,5)
					
					obj.parent.&lcGo..setfocus
				ENDIF
			CASE nKeyCode=19	&& LfArr
				NODEFAULT
				lnNum=lnNUm-1
				IF lnNum>0
					lcGo="Text"+LTRIM(STR(lnNUm))
					IF PEMSTATUS(obj.parent,lcGo,5)
						
						obj.parent.&lcGo..setfocus
					ENDIF
				ENDIF					
		ENDCASE
		
	ENDPROC

	PROCEDURE bindlost
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		obj.DisabledBackColor=this.dbcolor
		obj.Forecolor=this.focolor
		
	ENDPROC

	PROCEDURE Destroy
		this.objManak=null
		IF VARTYPE(this.frmmanak)="O"
			this.frmmanak.release
			this.frmmanak=null
		ENDIF
		REMOVEPROPERTY(this,"objManak")
		REMOVEPROPERTY(this,"frmManak")
		SYS(2002,1)
		
	ENDPROC

	PROCEDURE gmes
		LPARAMETERS XNANO,XNMES,xlFocus
		LOCAL nd,fd,ff,bini,lcFoco,lcnum,lnNum,lFeria,oControl,;
			lcTool,lcText,diafin
		FD=DATE(XNANO,XNMES,1)
		FF=this.objManak.Findemes(xnano,xnMes)
		diafin=DAY(ff)
		IF this.dia>diafin
			this.dia=diafin
		ENDIF
		
		BINI=DOW(FD)
		nd=1
		lcFoco="Text"+LTRIM(STR(bini))
		FOR EACH OCONTROL IN this.Controls
			IF UPPER(ocontrol.baseclass)=="TEXTBOX"
				lcNum=CHRTRAN(ocontrol.name,CHRTRAN(ocontrol.Name,"1234567890",""),"")
				lnNum=VAL(lcnum)
				DO case
					CASE INLIST(lnNUm,1,8,15,22,29,36)
						*ocontrol.DisabledbackColor=RGB(255,0,0)
						ocontrol.DisabledbackColor=RGB(255,91,90)
						oControl.ForeColor=RGB(255,255,255)
					
					CASE INLIST(lnNUm,7,14,21,28,35,42)
						*oControl.DisabledbackColor=RGB(1,150,199)
						oControl.DisabledbackColor=RGB(1,173,231)
						oControl.ForeColor=RGB(255,255,255)
					
					OTHERWISE
						oControl.DisabledBackcolor=RGB(242,247,243)
						oControl.ForeColor=RGB(0,0,0)
					
				ENDCASE
				
				oControl.Value=0
			ENDIF
		ENDFOR
		* FERIADOS
		* Clave1: DTOS(DIA)   [IFERIADOS]
		* Clave2: MESANO   [IFERIMES]
		
		DO WHILE .T.
		
			lctool=""
		*	LFERIA=This.funmanak1.feriafix(this.mes*100+nd,@lcTool)
			lFeria=this.objmanak.Feriafix(this.mes*100+nd,@lcTool)
			IF !lFeria
				LDDATE=DATE(THIS.ANO,THIS.MES,ND)
				IF INDEXSEEK(DTOS(lddate),.f.,"curFeriados","IFERIADOS")
					INDEXSEEK(DTOS(lddate),.t.,"curFeriados","IFERIADOS")
					lcTool=ALLTRIM(curFeriados.motivo)
					LFERIA=.T.
				ENDIF
			endif
			lcText="Text"+LTRIM(STR(bini))
			WITH this.&lcText.
				.Value=nd
				.tooltiptext=lcTool
				IF LFERIA
					.DisabledBackColor=RGB(255,0,0)
					.ForeColor=RGB(255,255,255)
				ENDIF			
				
			ENDWITH
			IF nd=this.dia
				lcFoco="Text"+LTRIM(STR(bini))
			ENDIF		
			bini=bini+1	
			nd=nd+1
			IF nd>diafin
				EXIT
			ENDIF
		ENDDO
		nSumDia=0
		FOR EACH ocontrol IN this.Controls
			IF UPPER(ocontrol.baseclass)=="TEXTBOX"
				lcNum=CHRTRAN(ocontrol.name,CHRTRAN(ocontrol.Name,"1234567890",""),"")
				lnNum=VAL(lcnum)
				IF BETWEEN(lnNum,36,42)
					nSumDia=nSumdia+ocontrol.value
				ENDIF
					
			ENDIF
		ENDFOR
		
		WITH this
			.gmarco3.Visible=!EMPTY(nSumDia)
			.CntFe.top=IIF(.gmarco3.visible,.gmarco3.top+.gmarco3.Height,;
				.gmarco2.top+.gmarco2.Height)-1
		
			.cntfe.txfecha.Value=DATE(.ano,.mes,.dia)
		
			.Shape3d1.Height=.Cntfe.Top+.Cntfe.Height-.Shape3d1.top+5
			.Cnthoy1.Top=.cntfe.Top+3
			.Height=.Shape3d1.Top+.Shape3d1.Height+1
			.Width=.Shape3d1.width+1
			IF xlFocus
				.&lcFoco..SetFocus	
			ENDIF
			
		ENDWITH
		this.Parent.tryforma()
		
	ENDPROC

	PROCEDURE Init
		local lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		SYS(2002)
		This.AddProperty("objManak",null)
		This.AddProperty("frmManak",null)
		this.objManak=NEWOBJECT("funmanak",lcRoot,"",.t.)
		with this
			dimension .ZenMes(12)
			.ZenMes[1] = "ENERO"
			.ZenMes[2] = "FEBRERO"
			.ZenMes[3] = "MARZO"
			.ZenMes[4] = "ABRIL"
			.ZenMes[5] = "MAYO"
			.ZenMes[6] = "JUNIO"
			.ZenMes[7] = "JULIO"
			.ZenMes[8] = "AGOSTO"
			.ZenMes[9] = "SEPTIEMBRE"
			.ZenMes[10] = "OCTUBRE"
			.ZenMes[11] = "NOVIEMBRE"
			.ZenMes[12] = "DICIEMBRE"
		
			Dimension .aDiasem(7)
			.aDiaSem[1]="Domingo"
			.aDiaSem[2]="Lunes"
			.aDiaSem[3]="Martes"
			.aDiaSem[4]="Miércoles"
			.aDiaSem[5]="Jueves"
			.aDiaSem[6]="Viernes"
			.aDiaSem[7]="Sábado"
			.ano=YEAR(DATE())
			.mes=MONTH(DATE())
			.dia=DAY(DATE())
			.selperi=.ano*100+.mes
			.selmes=Proper(This.ZenMes[this.mes])
			.masdias=30
			.Shape3d1.Top=.Shape3d2.Top+.Shape3d2.Height
			.Shape3d1.Left=1
			.gmarco1.Top=.TExt1.Top
			.gmarco2.Top=.text29.Top
			.gmarco3.Top=.text36.Top
			.gmarco1.Left=.TExt1.Left
			.gmarco2.Left=.text29.Left
			.gmarco3.Left=.text36.Left	
		endwith
		
		ADDPROPERTY(_screen,"Fechasel",null)
		
		
		
		
		with this.combo1
			.clear
		*	.ControlSource='This.SelMes'
			for i=1 to 12
				.addlistitem(PROPER(this.ZenMes[i]),i,1)
			next
			.requery
			.refresh
		ENDWITH
		this.cnthoy1.objmanak=this
		
		
		
	ENDPROC

	PROCEDURE thcentrar
		LPARAMETERS wCont , wObje ,xnLeft,xnRight 
		if Vartype(xnLeft)#"N"
			xnleft=0
		endif
		if Vartype(xnright)#"N"
			xnright=0
		endif
		wCont=wCont - (xnLeft+xnRight)
		return xnLeft+ ( Round(wCont/2,0) - Round(wObje/2,0) )
	ENDPROC

	PROCEDURE CmCalc.Click
		local lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		SYS(2002,1)
		IF ISNULL(this.Parent.frmManak)
			this.Parent.frmmanak=NEWOBJECT("frmCalc",lcRoot,"",0)
		ELSE
			this.Parent.frmManak.WindowState=0
		ENDIF
		this.parent.frmManak.show()
		
	ENDPROC

	PROCEDURE cmgMeses.Click
		DO CASE 
			CASE this.Value=1
		
				this.cmdMesAnt.Enabled=.f.
				WITH this.Parent
					.MES=.MEs - 1
					IF .MES=0
						.MES=12
						.ano=.ANO-1
					ENDIF
					.GMEs(.ano,.mes,.t.)
				ENDWITH
				
				this.cmdMesAnt.Enabled=.t.
				
			CASE this.Value=2
				this.cmdMessig.Enabled=.f.
				WITH this.Parent
					.MES=.MEs + 1
					IF .MES=13
						.MES=1
						.ano=.ANO + 1
					ENDIF
					.GMEs(.ano,.mes,.t.)		
				ENDWITH
				this.cmdMesSig.Enabled=.t.
		ENDCASE
		WITH this.Parent
			.Selmes=PROPER(this.Parent.ZenMes[.mes])
			.Combo1.REfresh
			.spinner2.refresh
		ENDWITH	
	ENDPROC

	PROCEDURE Cntfe.TxFecha.ProgrammaticChange
		LOCAL objParent
		objParent=this.Parent.Parent
		this.Visible=!EMPTY(this.Value)
		_Screen.FEchasel=this.Value
		objParent.cnthoy1.getestado()
		
		this.Parent.edit1.Value=objParent.adiasem[DOW(this.value)]+" ";
			+TRANSFORM(DAY(this.Value));
			+" de ";
			+PROPER(objParent.ZenMes[MONTH(this.Value)] ) ;
			+" de ";
			+TRANSFORM(YEAR(this.Value))	
		
		
		
		
	ENDPROC

	PROCEDURE CntTit.Container1.Init
		WITH this
			.glab1.Top=this.Parent.Parent.ThCentrar(.Height,.glab1.Height)
			.glab1.Left=this.Parent.Parent.thCentrar(.Width,.glab1.Width)
		ENDWITH
		
	ENDPROC

	PROCEDURE CntTit.Container2.Init
		WITH this
			.glab1.Top=this.Parent.Parent.ThCentrar(.Height,.glab1.Height)
			.glab1.Left=this.Parent.Parent.thCentrar(.Width,.glab1.Width)
		ENDWITH
		
	ENDPROC

	PROCEDURE CntTit.Container3.Init
		WITH this
			.glab1.Top=this.Parent.Parent.ThCentrar(.Height,.glab1.Height)
			.glab1.Left=this.Parent.Parent.thCentrar(.Width,.glab1.Width)
		ENDWITH
		
	ENDPROC

	PROCEDURE CntTit.Container4.Init
		WITH this
			.glab1.Top=this.Parent.Parent.ThCentrar(.Height,.glab1.Height)
			.glab1.Left=this.Parent.Parent.thCentrar(.Width,.glab1.Width)
		ENDWITH
		
	ENDPROC

	PROCEDURE CntTit.Container5.Init
		WITH this
			.glab1.Top=this.Parent.Parent.ThCentrar(.Height,.glab1.Height)
			.glab1.Left=this.Parent.Parent.thCentrar(.Width,.glab1.Width)
		ENDWITH
		
	ENDPROC

	PROCEDURE CntTit.Container6.Init
		WITH this
			.glab1.Top=this.Parent.Parent.ThCentrar(.Height,.glab1.Height)
			.glab1.Left=this.Parent.Parent.thCentrar(.Width,.glab1.Width)
		ENDWITH
		
	ENDPROC

	PROCEDURE CntTit.Container7.Init
		WITH this
			.glab1.Top=this.Parent.Parent.ThCentrar(.Height,.glab1.Height)
			.glab1.Left=this.Parent.Parent.thCentrar(.Width,.glab1.Width)
		ENDWITH
		
	ENDPROC

	PROCEDURE Combo1.Click
		NITEM=this.listitemId
		if nitem>0
			this.parent.mes=nitem
			this.parent.gmes(this.Parent.ano,this.Parent.mes,.t.)
		endif
	ENDPROC

	PROCEDURE Spinner2.InteractiveChange
		this.Parent.ano=this.value
		this.Parent.gmes(this.Parent.ano,this.Parent.mes,.t.)
	ENDPROC

	PROCEDURE Text1.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text10.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text11.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text12.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text13.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text14.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text15.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text16.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text17.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text18.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text19.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text2.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text20.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text21.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text22.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text23.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text24.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text25.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text26.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text27.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text28.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text29.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text3.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text30.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text31.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text32.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text33.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text34.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text35.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text36.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text37.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text38.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text39.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text4.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text40.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text41.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text42.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text5.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text6.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text7.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text8.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text9.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

ENDDEFINE

DEFINE CLASS cntfrm_manak AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shape3d1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text28" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text29" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text30" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text31" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text32" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text33" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text34" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text35" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text36" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text37" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text38" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text39" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text40" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text41" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text42" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.Gmarco4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.Semaf1001" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmgMeses" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cnthoy1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: bindclick
		*m: binddbl
		*m: bindfo
		*m: bindgo
		*m: bindlost
		*m: gmes
		*m: manak_bind
		*m: objfollow
		*p: ano
		*p: dbcolor
		*p: dia
		*p: diafoco
		*p: fechasel
		*p: focolor
		*p: lastfocus
		*p: masdias
		*p: mes
		*p: script
		*p: selmes
		*p: selperi
		*a: adiasem[7,0]		&& Dias de la semana
		*a: zenmes[12,0]		&& matriz de meses
	*</DefinedPropArrayMethod>

	ano = .F.
	BackStyle = 1
	BorderWidth = 0
	dbcolor = .F.
	dia = .F.
	diafoco = 
	fechasel = .F.
	focolor = .F.
	Height = 236
	lastfocus = null
	masdias = 30
	mes = .F.
	Name = "cntfrm_manak"
	script = 
	selmes = .F.
	selperi = .F.
	Width = 305

	ADD OBJECT 'cmgMeses' AS commandgroup WITH ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 17, ;
		Left = 121, ;
		Name = "cmgMeses", ;
		Top = 5, ;
		Value = 1, ;
		Width = 40, ;
		Command1.BackColor = 149,177,171, ;
		Command1.Caption = "", ;
		Command1.DisabledPicture = ..\graphics\fle1132leftgn.bmp, ;
		Command1.Height = 16, ;
		Command1.Left = 1, ;
		Command1.Name = "cmdMesAnt", ;
		Command1.Picture = ..\graphics\fle1132leftg.bmp, ;
		Command1.SpecialEffect = 1, ;
		Command1.ToolTipText = "Mes Anterior", ;
		Command1.Top = 1, ;
		Command1.Width = 19, ;
		Command2.BackColor = 149,177,171, ;
		Command2.Caption = "", ;
		Command2.DisabledPicture = ..\graphics\fle1132rigthgn.bmp, ;
		Command2.Height = 16, ;
		Command2.Left = 20, ;
		Command2.Name = "cmdMesSig", ;
		Command2.Picture = ..\graphics\fle1132rightg.bmp, ;
		Command2.SpecialEffect = 1, ;
		Command2.ToolTipText = "Mes Siguiente", ;
		Command2.Top = 1, ;
		Command2.Width = 19
		*< END OBJECT: BaseClass="commandgroup" />

	ADD OBJECT 'Cntfe' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 19, ;
		Left = 4, ;
		Name = "Cntfe", ;
		Top = 4, ;
		Width = 177
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'Cntfe.Glab1' AS glab WITH ;
		Caption = "Mes y Año", ;
		Left = 6, ;
		Name = "Glab1", ;
		Top = 3
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'Cntfe.Gmarco4' AS gmarco WITH ;
		BackColor = 255,255,255, ;
		Height = 18, ;
		Left = 1, ;
		Name = "Gmarco4", ;
		Top = 1, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Cntfe.Semaf1001' AS semaf100 WITH ;
		Left = 156, ;
		Name = "Semaf1001", ;
		Top = 0, ;
		Visible = .F., ;
		iamarillo.Height = 18, ;
		iamarillo.Name = "iamarillo", ;
		iamarillo.Width = 20, ;
		irojo.Height = 18, ;
		irojo.Name = "irojo", ;
		irojo.Width = 20, ;
		iverde.Height = 18, ;
		iverde.Name = "iverde", ;
		iverde.Visible = .T., ;
		iverde.Width = 20
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="container" />

	ADD OBJECT 'Cnthoy1' AS cnthoy WITH ;
		Left = 157, ;
		Name = "Cnthoy1", ;
		Top = 160, ;
		imgHoy.Height = 18, ;
		imgHoy.Name = "imgHoy", ;
		imgHoy.Width = 22, ;
		imgNot.Height = 18, ;
		imgNot.Name = "imgNot", ;
		imgNot.Width = 22
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="container" />

	ADD OBJECT 'CntTit' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 18, ;
		Left = 4, ;
		Name = "CntTit", ;
		Top = 22, ;
		Width = 177
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Glab1' AS glab WITH ;
		Caption = "Dom", ;
		ForeColor = 255,255,255, ;
		Left = 4, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab2' AS glab WITH ;
		Caption = "Lun", ;
		ForeColor = 255,255,255, ;
		Left = 30, ;
		Name = "Glab2", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab3' AS glab WITH ;
		Caption = "Mar", ;
		ForeColor = 255,255,255, ;
		Left = 55, ;
		Name = "Glab3", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab4' AS glab WITH ;
		Caption = "Mie", ;
		ForeColor = 255,255,255, ;
		Left = 80, ;
		Name = "Glab4", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab5' AS glab WITH ;
		Caption = "Jue", ;
		ForeColor = 255,255,255, ;
		Left = 105, ;
		Name = "Glab5", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab6' AS glab WITH ;
		Caption = "Vie", ;
		ForeColor = 255,255,255, ;
		Left = 130, ;
		Name = "Glab6", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab7' AS glab WITH ;
		Caption = "Sab", ;
		ForeColor = 255,255,255, ;
		Left = 155, ;
		Name = "Glab7", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Gmarco1' AS gmarco WITH ;
		BackColor = 255,0,0, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 1, ;
		Name = "Gmarco1", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco2' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 26, ;
		Name = "Gmarco2", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco3' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 51, ;
		Name = "Gmarco3", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco4' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 76, ;
		Name = "Gmarco4", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco5' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 101, ;
		Name = "Gmarco5", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco6' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 126, ;
		Name = "Gmarco6", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco7' AS gmarco WITH ;
		BackColor = 1,150,199, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 151, ;
		Name = "Gmarco7", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco8' AS gmarco WITH ;
		BackStyle = 0, ;
		Height = 17, ;
		Left = 1, ;
		Name = "Gmarco8", ;
		Top = 1, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco1' AS gmarco WITH ;
		Height = 18, ;
		Left = 205, ;
		Name = "Gmarco1", ;
		Top = 40, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco2' AS gmarco WITH ;
		Height = 18, ;
		Left = 205, ;
		Name = "Gmarco2", ;
		Top = 108, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco3' AS gmarco WITH ;
		Height = 18, ;
		Left = 205, ;
		Name = "Gmarco3", ;
		Top = 125, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Shape3d1' AS shape3d WITH ;
		Height = 147, ;
		Left = 201, ;
		Name = "Shape3d1", ;
		Top = 1, ;
		Width = 185
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Text1' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text10' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text10", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text11' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text11", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text12' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text12", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text13' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text13", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text14' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text14", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text15' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text15", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text16' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text16", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text17' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text17", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text18' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text18", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text19' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text19", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text2' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text2", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text20' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text20", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text21' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text21", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text22' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text22", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text23' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text23", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text24' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text24", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text25' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text25", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text26' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text26", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text27' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text27", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text28' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text28", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text29' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text29", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text3' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text3", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text30' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text30", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text31' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text31", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text32' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text32", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text33' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text33", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text34' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text34", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text35' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text35", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text36' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text36", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text37' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text37", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text38' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text38", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text39' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text39", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text4' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text4", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text40' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text40", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text41' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text41", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text42' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text42", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text5' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text5", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text6' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text6", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text7' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text7", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text8' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text8", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text9' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text9", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE bindclick
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		WITH obj
		*	this.dbcolor=.Disabledbackcolor
		*	this.focolor=.Forecolor
			.DisabledBackColor=RGB(10,36,106)
			.ForeColor=RGB(255,255,255)
			.FontBold=.t.
		ENDWITH
		
		lnDay=obj.Value
		lcName=obj.Name
		vq=VAL(CHRTRAN(lcName,CHRTRAN(lcName,"1234567890",""),""))
		nText=IIF(MOD(vq,7)=0,7, vq - INT(vq/7) * 7 )
		lofoco="gLab"+LTRIM(STR(nText))
		FOR EACH oControl IN This.cntTit.Controls
			IF UPPER(ocontrol.baseclass)=="LABEL"
				oControl.FontBold=.f.
			ENDIF
		ENDFOR
		this.cntTit.&loFoco..FontBold=.t.
		this.dia=lnDay
		_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
		this.cnthoy1.getestado()
		*!*	this.cmdHoy.enabled=IIF(_screen.fechasel=DATE(),.f.,.t.)
		*!*	LdFEcha=DATE(this.ano,this.mes,this.dia)
		*!*	lcFrase=this.adiasem[DOW(ldFEcha)]+" ";
		*!*		+LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
		
	ENDPROC

	PROCEDURE binddbl
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		lnDay=obj.Value
		lcFrase=LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
		this.dia=lnDay
		_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
		this.cnthoy1.getestado()
		IF !EMPTY(this.script)
			EXECSCRIPT(this.script,thisform)
		ENDIF
		
		
	ENDPROC

	PROCEDURE bindfo
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		WITH obj
			this.dbcolor=.Disabledbackcolor
			this.focolor=.Forecolor
			.DisabledBackColor=RGB(10,36,106)
			.ForeColor=RGB(255,255,255)
			.FontBold=.t.
		ENDWITH
		this.lastfocus=obj
		lnDay=obj.Value
		lcName=obj.Name
		vq=VAL(CHRTRAN(lcName,CHRTRAN(lcName,"1234567890",""),""))
		nText=IIF(MOD(vq,7)=0,7, vq - INT(vq/7) * 7 )
		lofoco="gLab"+LTRIM(STR(nText))
		FOR EACH oControl IN This.cntTit.Controls
			IF UPPER(ocontrol.baseclass)=="LABEL"
				oControl.FontBold=.f.
			ENDIF
		ENDFOR
		this.cntTit.&loFoco..FontBold=.t.
		this.dia=lnDay
		_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
		this.cnthoy1.getestado()
		LdFEcha=DATE(this.ano,this.mes,this.dia)
		lcFrase=this.adiasem[DOW(ldFEcha)]+" ";
			+LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
		
		
	ENDPROC

	PROCEDURE bindgo
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		LOCAL obj,nEvents,nSalto,oCont,lcNum,lnNUm,lcName,lcOrd
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		lcNum=CHRTRAN(obj.name,CHRTRAN(obj.Name,"1234567890",""),"")
		lnNum=VAL(lcNum)
		
		lcName=obj.Parent.Name
		*MESSAGEBOX(obj.name+" "+lcName)
		
		lcOrd=CHRTRAN(lcName,CHRTRAN(lcName,"1234567890",""),"")
		DO case
			CASE nKeyCode=43 && +
				NODEFAULT
				lcCont=this.objfollow(obj.parent.Name)
				IF PEMSTATUS(thisform,lcCont,5)
					oCont=thisform.&lcCont
					oCont.dia=this.dia		
					oCont.gmes(oCont.ano,oCont.Mes,.t.)
				ENDIF
				
			CASE nKeyCode=45 && -
				NODEFAULT
				lcCont=this.objfollow(obj.parent.Name,-1)
				IF PEMSTATUS(thisform,lcCont,5)
					oCont=thisform.&lcCont
					oCont.dia=this.dia		
					oCont.gmes(oCont.ano,oCont.Mes,.t.)		
				ENDIF	
			CASE nKeyCode=13
				NODEFAULT
				
				lnDay=obj.Value
				lcFrase=LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
				this.dia=lnDay
				_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
				IF !EMPTY(this.script)
					EXECSCRIPT(this.script,thisform)
				ENDIF
			
			CASE nKeyCode=5		&& UpArrow
		
				NODEFAULT
				lcGo=this.objfollow(obj.name,-nSalto)
				IF lcGo#obj.Name
					IF PEMSTATUS(obj.parent,lcGo,5)
						obj.parent.&lcGo..setfocus
					ENDIF
				ENDIF
				
				
				
			CASE nKeyCode=24	&& DnArrow
				NODEFAULT
				lcGo=this.objfollow(obj.name,nSalto)
				IF PEMSTATUS(obj.parent,lcGo,5)
					obj.parent.&lcGo..setfocus
				ENDIF
			CASE nKeyCode=4		&& RightArrow
				NODEFAULT
				lcGo=this.objfollow(obj.name)
				IF PEMSTATUS(obj.parent,lcGo,5)
					obj.parent.&lcGo..setfocus
				ENDIF	
			CASE nKeyCode=19	&& leftArrow
				NODEFAULT
				lcGo=this.objfollow(obj.name,-1)
				IF PEMSTATUS(obj.parent,lcGo,5)
					
					obj.parent.&lcGo..setfocus
				ENDIF		
			
			CASE nkeyCode=3		&& PageDown
				NODEFAULT
				lcCont=this.objfollow(lcName,4)
				IF PEMSTATUS(thisform,lcCont,5)
					oCont=thisform.&lcCont
					oCont.dia=this.dia		
					oCont.gmes(oCont.ano,oCont.Mes,.t.)
				ELSE
					IF VAL(lcOrd)#12
						lcCont=this.objfollow(lcName,-7)
						IF PEMSTATUS(thisform,lcCont,5)
							oCont=thisform.&lcCont
							oCont.dia=this.dia		
							oCont.gmes(oCont.ano,oCont.Mes,.t.)			
						ENDIF
					ENDIF
				ENDIF
				
			CASE nkeycode=18	&& PageUp	
				NODEFAULT
				IF VAL(lcOrd)=1
					RETURN
				ENDIF
				
				lcCont=this.objfollow(obj.parent.Name,-4)
			*	MESSAGEBOX("lcOrd="+lcOrd+CHR(13);
			*		+"Next cnt="+lcCont)
			
				lAlter=IIF(obj.Parent.Name==lcCont,.t.,.f.)
				IF !lAlter
					IF PEMSTATUS(thisform,lcCont,5)
						oCont=thisform.&lcCont
						oCont.dia=this.dia		
						oCont.gmes(oCont.ano,oCont.Mes,.t.)
					ELSE
						lAlter=.t.
					ENDIF
				ENDIF
				
				IF lAlter
					lcCont=this.objfollow(lcName,7)
					IF PEMSTATUS(thisform,lcCont,5)
						oCont=thisform.&lcCont
						oCont.dia=this.dia		
						oCont.gmes(oCont.ano,oCont.Mes,.t.)			
					ENDIF
				ENDIF		
				
						
		ENDCASE
		this.cnthoy1.getestado()
		
	ENDPROC

	PROCEDURE bindlost
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		obj.DisabledBackColor=this.dbcolor
		obj.Forecolor=this.focolor
		obj.FontBold=.f.
	ENDPROC

	PROCEDURE Destroy
		*
		this.objManak=null
		REMOVEPROPERTY(this,"objManak")
	ENDPROC

	PROCEDURE gmes
		LPARAMETERS XNANO,XNMES,xlFoco
		FD=DATE(XNANO,XNMES,1)
		FF=this.objManak.Findemes(xnano,xnmes)
		diafin=DAY(ff)
		IF this.dia>diafin
			this.dia=diafin
		ENDIF
		
		BINI=DOW(FD)
		nd=1
		lcFoco="Text"+LTRIM(STR(bini))
		FOR EACH OCONTROL IN this.Controls
			IF UPPER(ocontrol.baseclass)=="TEXTBOX"
				lcNum=CHRTRAN(ocontrol.name,CHRTRAN(ocontrol.Name,"1234567890",""),"")
				lnNum=VAL(lcnum)
				DO case
					CASE INLIST(lnNUm,1,8,15,22,29,36)
						*ocontrol.DisabledbackColor=RGB(255,0,0)
						ocontrol.DisabledbackColor=RGB(255,91,90)
						oControl.ForeColor=RGB(255,255,255)
					
					CASE INLIST(lnNUm,7,14,21,28,35,42)
						*oControl.DisabledbackColor=RGB(1,150,199)
						oControl.DisabledbackColor=RGB(1,173,231)
						oControl.ForeColor=RGB(255,255,255)
					
					OTHERWISE
						oControl.DisabledBackcolor=RGB(242,247,243)
						oControl.ForeColor=RGB(0,0,0)
					
				ENDCASE
				
				oControl.Value=0
			ENDIF
		ENDFOR
		* FERIADOS
		* Clave1: DTOS(DIA)   [IFERIADOS]
		* Clave2: MESANO   [IFERIMES]
		
		DO WHILE .T.
			lctool=""
		*	LFERIA=This.funmanak1.feriafix(this.mes*100+nd,@lcTool)
			lFeria=This.objManak.feriafix(this.mes*100+nd,@lcTool)
			IF !lFeria
				LDDATE=DATE(THIS.ANO,THIS.MES,ND)
				IF INDEXSEEK(DTOS(lddate),.f.,"curFeriados","IFERIADOS")
					INDEXSEEK(DTOS(lddate),.t.,"curFeriados","IFERIADOS")
					lcTool=ALLTRIM(curFeriados.motivo)
					LFERIA=.T.
				ENDIF
			endif	
		
			lcText="Text"+LTRIM(STR(bini))
			*this.&lcText.
			WITH this.&lcText.
				.Value=nd
				IF LFERIA
					.DisabledBackColor=RGB(255,0,0)
					.ForeColor=RGB(255,255,255)
				ENDIF			
				.tooltiptext=lcTool
			ENDWITH
			
			IF nd=this.dia
				lcFoco="Text"+LTRIM(STR(bini))
			ENDIF	
			bini=bini+1	
			nd=nd+1
			IF nd>diafin
				EXIT
			ENDIF
		ENDDO
		nSumDia=0
		FOR EACH ocontrol IN this.Controls
			IF UPPER(ocontrol.baseclass)=="TEXTBOX"
				lcNum=CHRTRAN(ocontrol.name,CHRTRAN(ocontrol.Name,"1234567890",""),"")
				lnNum=VAL(lcnum)
				IF BETWEEN(lnNum,36,42)
					nSumDia=nSumdia+ocontrol.value
				ENDIF
					
			ENDIF
		ENDFOR
		WITH this.cntfe.semaf1001
			.irojo.visible=IIF(this.Ano#YEAR(DATE()),.t.,.f.)
			.iamarillo.visible=IIF(this.ano=YEAR(DATE()) AND this.mes#MONTH(DATE()),.t.,.f.)
			.iverde.visible=IIF(this.ano=YEAR(DATE()) and this.mes=MONTH(DATE()),.t.,.f.)
		ENDWITH
		WITH this
			_Screen.fechasel=DATE(.ano,.mes,.dia)
			.cnthoy1.getestado()	
			.lastfocus=.&lcFoco
			.selmes=Proper(.ZenMes[.mes])
			.CntFe.glab1.Caption=.Selmes+" de "+LTRIM(STR(.ano))
			.gmarco3.Visible=!EMPTY(nSumDia)
			.dbcolor=.&lcFoco..Disabledbackcolor
			.focolor=.&lcfoco..Forecolor	
		*	.gmarco3.Visible=.t.
		*	obtop=IIF(.gmarco3.visible,.gmarco3.top+.gmarco3.Height,;
		*		.gmarco2.top+.gmarco2.Height)-1
		*
		*	.Shape3d1.Height=obTop+.gmarco3.Height-.Shape3d1.top+5
			.cntHoy1.Top=.gmarco3.Top
		*	.cntHoy1.Left=.gmarco3.Left+.gmarco3.Width-.cntHoy1.Width-1
			.cntHoy1.Left=.shape3d1.Left+.shape3d1.Width-.cntHoy1.Width-5
			.Height=.Shape3d1.Top+.Shape3d1.Height+1
			.Width=.Shape3d1.width+1
			IF xlFoco
				.&lcFoco..SetFocus	
			endif
		ENDWITH
		
		
	ENDPROC

	PROCEDURE GotFocus
		WITH this.cntfe
			.glab1.FontBold=.t.
			.semaf1001.Visible=.t.
		ENDWITH
		SYS(2002)
	ENDPROC

	PROCEDURE Init
		LPARAMETERS xnAno,xnmes
		local lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		This.AddProperty("objManak",null)
		this.objManak=NEWOBJECT("funmanak",lcRoot,"",.t.)
		with this
			.lastfocus=null
			.ano=xnAno
			.mes=xnMes
			dimension .ZenMes(12)
			.ZenMes[1] = "ENERO"
			.ZenMes[2] = "FEBRERO"
			.ZenMes[3] = "MARZO"
			.ZenMes[4] = "ABRIL"
			.ZenMes[5] = "MAYO"
			.ZenMes[6] = "JUNIO"
			.ZenMes[7] = "JULIO"
			.ZenMes[8] = "AGOSTO"
			.ZenMes[9] = "SEPTIEMBRE"
			.ZenMes[10] = "OCTUBRE"
			.ZenMes[11] = "NOVIEMBRE"
			.ZenMes[12] = "DICIEMBRE"
		
			Dimension .aDiasem(7)
			.aDiaSem[1]="Domingo"
			.aDiaSem[2]="Lunes"
			.aDiaSem[3]="Martes"
			.aDiaSem[4]="Miércoles"
			.aDiaSem[5]="Jueves"
			.aDiaSem[6]="Viernes"
			.aDiaSem[7]="Sábado"
		
			.dia=1
			.selperi=.ano*100+.mes
			.selmes=Proper(This.ZenMes[this.mes])
			.masdias=30
			.Shape3d1.Top=1
			.Shape3d1.Left=1
			.gmarco1.Top=.TExt1.Top
			.gmarco2.Top=.text29.Top
			.gmarco3.Top=.text36.Top
			.gmarco1.Left=.TExt1.Left
			.gmarco2.Left=.text29.Left
			.gmarco3.Left=.text36.Left	
			.CntFe.glab1.Caption=.Selmes+" de "+LTRIM(STR(.ano))
		ENDWITH
		WITH THIS.Cntfe.semaf1001
			.vISIBLE=.t.
			.IVERde.Visible=.T.
			.IROJO.VISIBLE=.F.
			.IAMARILLO.VISIBLE=.F.
		ENDWITH
		this.cnthoy1.objmanak=this
		this.gmes(this.ano,this.mes)
		*ADDPROPERTY(_screen,"Fechasel",null)
		
		
		
		
		
		
		
		
	ENDPROC

	PROCEDURE LostFocus
		WITH this.cntfe
			.glab1.FontBold=.f.
		*	.semaf1001.Visible=.F.
		ENDWITH
		SYS(2002,1)
		
	ENDPROC

	PROCEDURE manak_bind
		LOCAL objIn
		FOR EACH objin IN this.controls
			IF UPPER(objIn.baseclass)=="TEXTBOX"
				objIn.selectonentry=.t.
				BINDEVENT(objIn,"KeyPress",this,"bindgo")
				BINDEVENT(objIn,"Gotfocus",this,"bindfo")
				BINDEVENT(objIN,"Click",this,"Bindclick")
				BINDEVENT(objIn,"DblClick",this,"bindDbl")
				BINDEVENT(objIn,"LostFocus",this,"BindLost")
			ENDIF
		ENDFOR
	ENDPROC

	PROCEDURE objfollow
		LPARAMETERS xcObjeto , xnAdd
		************************************
		* Para un objeto "text1", si xnAdd=1 Devolvera "text2"
		* Para un Objeto "Text1", si xnAdd= -1, Devolvera "Text1"
		* --------------------------------------------------------
		LOCAL lcnum,lnNum
		IF VARTYPE(xcObjeto)#"C" OR empty(xcObjeto)
			RETURN ""
		ENDIF
		IF VARTYPE(xnAdd)#"N" OR empty(xnAdd)
			xnADd=1
		ENDIF
		lcNum=CHRTRAN(m.xcObjeto,CHRTRAN(m.xcObjeto,"1234567890",""),"")
		lnNum=VAL(m.lcNum)+m.xnAdd
		RETURN IIF(m.lnNum>0,STRTRAN(m.xcObjeto,m.lcnum)+LTRIM(STR(m.lnNum)),m.xcObjeto)
		
	ENDPROC

	PROCEDURE cmgMeses.Click
		DO CASE 
			CASE this.Value=1
		
				this.cmdMesAnt.Enabled=.f.
				WITH this.Parent
					.MES=.MEs - 1
					IF .MES=0
						.MES=12
						.ano=.ANO-1
					ENDIF
					.GMEs(.ano,.mes,.t.)
				ENDWITH
				
				this.cmdMesAnt.Enabled=.t.
				
			CASE this.Value=2
				this.cmdMessig.Enabled=.f.
				WITH this.Parent
					.MES=.MEs + 1
					IF .MES=13
						.MES=1
						.ano=.ANO + 1
					ENDIF
					.GMEs(.ano,.mes,.t.)		
				ENDWITH
				this.cmdMesSig.Enabled=.t.
		ENDCASE
		
			
	ENDPROC

	PROCEDURE Cntfe.Click
		IF VARTYPE(this.Parent.lastfocus)="O"
			this.Parent.lastfocus.setfocus
		ENDIF
		
	ENDPROC

	PROCEDURE Cntfe.DblClick
		IF VARTYPE(this.Parent.lastfocus)="O"
			this.Parent.lastfocus.setfocus
		ENDIF
	ENDPROC

	PROCEDURE Cntfe.Glab1.Click
		IF VARTYPE(this.Parent.Parent.lastfocus)="O"
			this.Parent.parent.lastfocus.setfocus
		ENDIF
	ENDPROC

	PROCEDURE Cntfe.Glab1.DblClick
		IF VARTYPE(this.Parent.Parent.lastfocus)="O"
			this.Parent.parent.lastfocus.setfocus
		ENDIF
	ENDPROC

	PROCEDURE Cntfe.Gmarco4.Click
		IF VARTYPE(this.Parent.Parent.lastfocus)="O"
			this.Parent.parent.lastfocus.setfocus
		ENDIF
	ENDPROC

	PROCEDURE Cntfe.Gmarco4.DblClick
		IF VARTYPE(this.Parent.Parent.lastfocus)="O"
			this.Parent.parent.lastfocus.setfocus
		ENDIF
	ENDPROC

	PROCEDURE Shape3d1.Click
		IF VARTYPE(this.Parent.lastfocus)="O"
			this.Parent.lastfocus.setfocus
		ENDIF
	ENDPROC

	PROCEDURE Shape3d1.DblClick
		IF VARTYPE(this.Parent.lastfocus)="O"
			this.Parent.lastfocus.setfocus
		ENDIF
	ENDPROC

	PROCEDURE Text1.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text10.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text11.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text12.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text13.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text14.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text15.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text16.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text17.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text18.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text19.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text2.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text20.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text21.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text22.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text23.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text24.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text25.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text26.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text27.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text28.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text29.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text3.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text30.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text31.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text32.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text33.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text34.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text35.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text36.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text37.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text38.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text39.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text4.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text40.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text41.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text42.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text5.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text6.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text7.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text8.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text9.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

ENDDEFINE

DEFINE CLASS cnthoy AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="imgHoy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="imgNot" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: getestado
		*p: objmanak
	*</DefinedPropArrayMethod>

	BackStyle = 0
	BorderColor = 114,136,141
	BorderWidth = 1
	Height = 17
	Name = "cnthoy"
	objmanak = .F.
	Width = 20

	ADD OBJECT 'imgHoy' AS image WITH ;
		Height = 15, ;
		Left = 1, ;
		Name = "imgHoy", ;
		Picture = ..\graphics\almanak1519.bmp, ;
		ToolTipText = "Ir al dia de la fecha", ;
		Top = 1, ;
		Width = 19
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'imgNot' AS image WITH ;
		BackStyle = 0, ;
		Height = 15, ;
		Left = 1, ;
		Name = "imgNot", ;
		Picture = ..\graphics\almanak1519n.bmp, ;
		Top = 1, ;
		Width = 19
		*< END OBJECT: BaseClass="image" />
	
	PROCEDURE getestado
		LOCAL dFecha
		dfecha=DATE(this.objmanak.ano,this.objmanak.mes,this.objmanak.dia)
		WITH this
			.imgHoy.Visible=IIF(dFecha=DATE(),.f.,.t.)
			.imgNot.Visible=IIF(dfecha=DATE(),.t.,.f.)
			.BorderColor=IIF(.imgHoy.Visible,RGB(0,128,128),RGB(114,136,141))
		ENDWITH
		
		
		
		
	ENDPROC

	PROCEDURE Init
		this.imgHoy.ToolTipText="Ir al dia "+DTOC(DATE())
	ENDPROC

	PROCEDURE imgHoy.Click
		LOCAL objManak
		objManak=this.Parent.objmanak
		WITH objmanak
			.dia=DAY(DATE())
			.mes=MONTH(DATE())
			.ano=YEAR(DATE())
		ENDWITH
		*THIS.Parent.objmanak.GMEs(this.Parent.ano,this.Parent.mes,.t.)	
		*this.Parent.objmanak.dia=DAY(DATE())
		objmanak.gMes(objmanak.ano,objManak.mes,.t.)
		IF objmanak.class="Cntalma"
			WITH objmanak
				.Selmes=PROPER(objManak.ZenMes[.mes])
				.Combo1.REfresh
				.spinner2.refresh
			ENDWITH	
		ENDIF
		
		
	ENDPROC

ENDDEFINE

DEFINE CLASS cntmanak AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shape3d1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text28" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text29" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text30" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text31" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text32" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text33" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text34" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text35" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gmarco3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text36" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text37" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text38" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text39" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text40" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text41" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text42" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.Gmarco4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntfe.Semaf1001" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Glab7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntTit.Gmarco8" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: binddbl
		*m: bindfo
		*m: bindgo
		*m: bindlost
		*m: gmes
		*m: objfollow
		*p: ano
		*p: dbcolor
		*p: dia
		*p: diafoco
		*p: fechasel
		*p: focolor
		*p: masdias
		*p: mes
		*p: selmes
		*p: selperi
		*a: adiasem[7,0]		&& Dias de la semana
		*a: zenmes[12,0]		&& matriz de meses
	*</DefinedPropArrayMethod>

	ano = .F.
	BackStyle = 1
	BorderWidth = 0
	dbcolor = .F.
	dia = .F.
	diafoco = 
	fechasel = .F.
	focolor = .F.
	Height = 267
	masdias = 30
	mes = .F.
	Name = "cntmanak"
	selmes = .F.
	selperi = .F.
	Width = 242

	ADD OBJECT 'Cntfe' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 19, ;
		Left = 4, ;
		Name = "Cntfe", ;
		Top = 4, ;
		Width = 177
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'Cntfe.Glab1' AS glab WITH ;
		Caption = "Mes y Año", ;
		Left = 6, ;
		Name = "Glab1", ;
		Top = 3
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'Cntfe.Gmarco4' AS gmarco WITH ;
		BackColor = 255,255,255, ;
		Height = 18, ;
		Left = 1, ;
		Name = "Gmarco4", ;
		Top = 1, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Cntfe.Semaf1001' AS semaf100 WITH ;
		Left = 156, ;
		Name = "Semaf1001", ;
		Top = 0, ;
		Visible = .F., ;
		iamarillo.Height = 18, ;
		iamarillo.Name = "iamarillo", ;
		iamarillo.Width = 20, ;
		irojo.Height = 18, ;
		irojo.Name = "irojo", ;
		irojo.Width = 20, ;
		iverde.Height = 18, ;
		iverde.Name = "iverde", ;
		iverde.Visible = .T., ;
		iverde.Width = 20
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="container" />

	ADD OBJECT 'CntTit' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 18, ;
		Left = 4, ;
		Name = "CntTit", ;
		Top = 22, ;
		Width = 177
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntTit.Glab1' AS glab WITH ;
		Caption = "Dom", ;
		ForeColor = 255,255,255, ;
		Left = 4, ;
		Name = "Glab1", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab2' AS glab WITH ;
		Caption = "Lun", ;
		ForeColor = 255,255,255, ;
		Left = 30, ;
		Name = "Glab2", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab3' AS glab WITH ;
		Caption = "Mar", ;
		ForeColor = 255,255,255, ;
		Left = 55, ;
		Name = "Glab3", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab4' AS glab WITH ;
		Caption = "Mie", ;
		ForeColor = 255,255,255, ;
		Left = 80, ;
		Name = "Glab4", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab5' AS glab WITH ;
		Caption = "Jue", ;
		ForeColor = 255,255,255, ;
		Left = 105, ;
		Name = "Glab5", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab6' AS glab WITH ;
		Caption = "Vie", ;
		ForeColor = 255,255,255, ;
		Left = 130, ;
		Name = "Glab6", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Glab7' AS glab WITH ;
		Caption = "Sab", ;
		ForeColor = 255,255,255, ;
		Left = 155, ;
		Name = "Glab7", ;
		Top = 2
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntTit.Gmarco1' AS gmarco WITH ;
		BackColor = 255,0,0, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 1, ;
		Name = "Gmarco1", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco2' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 26, ;
		Name = "Gmarco2", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco3' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 51, ;
		Name = "Gmarco3", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco4' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 76, ;
		Name = "Gmarco4", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco5' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 101, ;
		Name = "Gmarco5", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco6' AS gmarco WITH ;
		BackColor = 73,136,160, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 126, ;
		Name = "Gmarco6", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco7' AS gmarco WITH ;
		BackColor = 1,150,199, ;
		BorderColor = 242,247,243, ;
		Height = 17, ;
		Left = 151, ;
		Name = "Gmarco7", ;
		Top = 1, ;
		Width = 26
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntTit.Gmarco8' AS gmarco WITH ;
		BackStyle = 0, ;
		Height = 17, ;
		Left = 1, ;
		Name = "Gmarco8", ;
		Top = 1, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco1' AS gmarco WITH ;
		Height = 18, ;
		Left = 205, ;
		Name = "Gmarco1", ;
		Top = 40, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco2' AS gmarco WITH ;
		Height = 18, ;
		Left = 205, ;
		Name = "Gmarco2", ;
		Top = 108, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Gmarco3' AS gmarco WITH ;
		Height = 18, ;
		Left = 205, ;
		Name = "Gmarco3", ;
		Top = 125, ;
		Width = 176
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Shape3d1' AS shape3d WITH ;
		Height = 147, ;
		Left = 201, ;
		Name = "Shape3d1", ;
		Top = 1, ;
		Width = 185
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'Text1' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text10' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text10", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text11' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text11", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text12' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text12", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text13' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text13", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text14' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text14", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text15' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text15", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text16' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text16", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text17' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text17", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text18' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text18", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text19' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text19", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text2' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text2", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text20' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text20", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text21' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text21", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 74, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text22' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text22", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text23' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text23", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text24' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text24", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text25' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text25", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text26' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text26", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text27' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text27", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text28' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text28", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 91, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text29' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text29", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text3' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text3", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text30' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text30", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text31' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text31", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text32' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text32", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text33' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text33", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text34' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text34", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text35' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text35", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 108, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text36' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text36", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text37' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text37", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text38' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 55, ;
		Name = "Text38", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text39' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text39", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text4' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 80, ;
		Name = "Text4", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text40' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text40", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text41' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text41", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text42' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text42", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 125, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text5' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 105, ;
		Name = "Text5", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text6' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 130, ;
		Name = "Text6", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text7' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 1,173,231, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 155, ;
		Name = "Text7", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 40, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text8' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 255,91,91, ;
		DisabledForeColor = 255,255,255, ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 5, ;
		Name = "Text8", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text9' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 18, ;
		InputMask = "99", ;
		Left = 30, ;
		Name = "Text9", ;
		ReadOnly = .T., ;
		SelectedBackColor = 10,36,106, ;
		SelectedForeColor = 255,255,255, ;
		SelectOnEntry = .T., ;
		SpecialEffect = 1, ;
		Top = 57, ;
		Value = 0, ;
		Width = 26
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE binddbl
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		lnDay=obj.Value
		lcFrase=LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
		this.dia=lnDay
		_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
		thisform.Release
		
		
	ENDPROC

	PROCEDURE bindfo
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		WITH obj
			this.dbcolor=.Disabledbackcolor
			this.focolor=.Forecolor
			.DisabledBackColor=RGB(10,36,106)
			.ForeColor=RGB(255,255,255)
			.FontBold=.t.
		ENDWITH
		
		lnDay=obj.Value
		lcName=obj.Name
		vq=VAL(CHRTRAN(lcName,CHRTRAN(lcName,"1234567890",""),""))
		nText=IIF(MOD(vq,7)=0,7, vq - INT(vq/7) * 7 )
		lofoco="gLab"+LTRIM(STR(nText))
		FOR EACH oControl IN This.cntTit.Controls
			IF UPPER(ocontrol.baseclass)=="LABEL"
				oControl.FontBold=.f.
			ENDIF
		ENDFOR
		this.cntTit.&loFoco..FontBold=.t.
		this.dia=lnDay
		thisform.cntins.pofechoy1.getEstado(this)
		LdFEcha=DATE(this.ano,this.mes,this.dia)
		lcFrase=this.adiasem[DOW(ldFEcha)]+" ";
			+LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
		
		
	ENDPROC

	PROCEDURE bindgo
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		LOCAL obj,nEvents,nSalto,oCont,lcNum,lnNUm,lcName,lcOrd
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		lcNum=CHRTRAN(obj.name,CHRTRAN(obj.Name,"1234567890",""),"")
		lnNum=VAL(lcNum)
		
		lcName=obj.Parent.Name
		*MESSAGEBOX(obj.name+" "+lcName)
		
		lcOrd=CHRTRAN(lcName,CHRTRAN(lcName,"1234567890",""),"")
		DO case
			CASE nKeyCode=43 && +
				NODEFAULT
				lcCont=this.objfollow(obj.parent.Name)
				IF PEMSTATUS(thisform,lcCont,5)
					oCont=thisform.&lcCont
					oCont.dia=this.dia		
					oCont.gmes(oCont.ano,oCont.Mes,.t.)
				ENDIF
				
			CASE nKeyCode=45 && -
				NODEFAULT
				lcCont=this.objfollow(obj.parent.Name,-1)
				IF PEMSTATUS(thisform,lcCont,5)
					oCont=thisform.&lcCont
					oCont.dia=this.dia		
					oCont.gmes(oCont.ano,oCont.Mes,.t.)		
				ENDIF	
			CASE nKeyCode=13
				NODEFAULT
				
				lnDay=obj.Value
				lcFrase=LTRIM(STR(lnDay))+" de "+this.selmes+" de "+LTRIM(STR(this.ano))
				this.dia=lnDay
				_Screen.Fechasel=DATE(this.ano,this.mes,this.dia)
				thisform.Release
			
			CASE nKeyCode=5		&& UpArrow
		
				NODEFAULT
				lcGo=this.objfollow(obj.name,-nSalto)
				IF lcGo#obj.Name
					IF PEMSTATUS(obj.parent,lcGo,5)
						obj.parent.&lcGo..setfocus
					ENDIF
				ENDIF
				
				
				
			CASE nKeyCode=24	&& DnArrow
				NODEFAULT
				lcGo=this.objfollow(obj.name,nSalto)
				IF PEMSTATUS(obj.parent,lcGo,5)
					obj.parent.&lcGo..setfocus
				ENDIF
			CASE nKeyCode=4		&& RightArrow
				NODEFAULT
				lcGo=this.objfollow(obj.name)
				IF PEMSTATUS(obj.parent,lcGo,5)
					obj.parent.&lcGo..setfocus
				ENDIF	
			CASE nKeyCode=19	&& leftArrow
				NODEFAULT
				lcGo=this.objfollow(obj.name,-1)
				IF PEMSTATUS(obj.parent,lcGo,5)
					
					obj.parent.&lcGo..setfocus
				ENDIF		
			
			CASE nkeyCode=3		&& PageDown
				NODEFAULT
				lcCont=this.objfollow(lcName,4)
				IF PEMSTATUS(thisform,lcCont,5)
					oCont=thisform.&lcCont
					oCont.dia=this.dia		
					oCont.gmes(oCont.ano,oCont.Mes,.t.)
				ELSE
					IF VAL(lcOrd)#12
						lcCont=this.objfollow(lcName,-7)
						IF PEMSTATUS(thisform,lcCont,5)
							oCont=thisform.&lcCont
							oCont.dia=this.dia		
							oCont.gmes(oCont.ano,oCont.Mes,.t.)			
						ENDIF
					ENDIF
				ENDIF
				
			CASE nkeycode=18	&& PageUp	
				NODEFAULT
				IF VAL(lcOrd)=1
					RETURN
				ENDIF
				
				lcCont=this.objfollow(obj.parent.Name,-4)
			*	MESSAGEBOX("lcOrd="+lcOrd+CHR(13);
			*		+"Next cnt="+lcCont)
			
				lAlter=IIF(obj.Parent.Name==lcCont,.t.,.f.)
				IF !lAlter
					IF PEMSTATUS(thisform,lcCont,5)
						oCont=thisform.&lcCont
						oCont.dia=this.dia		
						oCont.gmes(oCont.ano,oCont.Mes,.t.)
					ELSE
						lAlter=.t.
					ENDIF
				ENDIF
				
				IF lAlter
					lcCont=this.objfollow(lcName,7)
					IF PEMSTATUS(thisform,lcCont,5)
						oCont=thisform.&lcCont
						oCont.dia=this.dia		
						oCont.gmes(oCont.ano,oCont.Mes,.t.)			
					ENDIF
				ENDIF		
				
						
		ENDCASE
		*thisform.cntins.pofechoy1.getEstado(this)
		
	ENDPROC

	PROCEDURE bindlost
		LOCAL obj,nEvents,nSalto
		nSalto=7
		nEvents=AEVENTS(gaEvents,0)
		IF nEvents=0
			RETURN
		ENDIF
		obj=gaEvents[1]
		obj.DisabledBackColor=this.dbcolor
		obj.Forecolor=this.focolor
		obj.FontBold=.f.
	ENDPROC

	PROCEDURE Destroy
		*
		this.objManak=null
		REMOVEPROPERTY(this,"objManak")
	ENDPROC

	PROCEDURE gmes
		LPARAMETERS XNANO,XNMES,xlFoco
		FD=DATE(XNANO,XNMES,1)
		FF=this.objManak.Findemes(xnano,xnmes)
		diafin=DAY(ff)
		IF this.dia>diafin
			this.dia=diafin
		ENDIF
		
		BINI=DOW(FD)
		nd=1
		lcFoco="Text"+LTRIM(STR(bini))
		FOR EACH OCONTROL IN this.Controls
			IF UPPER(ocontrol.baseclass)=="TEXTBOX"
				lcNum=CHRTRAN(ocontrol.name,CHRTRAN(ocontrol.Name,"1234567890",""),"")
				lnNum=VAL(lcnum)
				DO case
					CASE INLIST(lnNUm,1,8,15,22,29,36)
						*ocontrol.DisabledbackColor=RGB(255,0,0)
						ocontrol.DisabledbackColor=RGB(255,91,90)
						oControl.ForeColor=RGB(255,255,255)
					
					CASE INLIST(lnNUm,7,14,21,28,35,42)
						*oControl.DisabledbackColor=RGB(1,150,199)
						oControl.DisabledbackColor=RGB(1,173,231)
						oControl.ForeColor=RGB(255,255,255)
					
					OTHERWISE
						oControl.DisabledBackcolor=RGB(242,247,243)
						oControl.ForeColor=RGB(0,0,0)
					
				ENDCASE
				
				oControl.Value=0
			ENDIF
		ENDFOR
		* FERIADOS
		* Clave1: DTOS(DIA)   [IFERIADOS]
		* Clave2: MESANO   [IFERIMES]
		
		DO WHILE .T.
			lctool=""
		*	LFERIA=This.funmanak1.feriafix(this.mes*100+nd,@lcTool)
			lFeria=This.objManak.feriafix(this.mes*100+nd,@lcTool)
			IF !lFeria
				LDDATE=DATE(THIS.ANO,THIS.MES,ND)
				IF INDEXSEEK(DTOS(lddate),.f.,"curFeriados","IFERIADOS")
					INDEXSEEK(DTOS(lddate),.t.,"curFeriados","IFERIADOS")
					lcTool=ALLTRIM(curFeriados.motivo)
					LFERIA=.T.
				ENDIF
			endif	
		
			lcText="Text"+LTRIM(STR(bini))
			*this.&lcText.
			WITH this.&lcText.
				.Value=nd
				IF LFERIA
					.DisabledBackColor=RGB(255,0,0)
					.ForeColor=RGB(255,255,255)
				ENDIF			
				.tooltiptext=lcTool
			ENDWITH
			
			IF nd=this.dia
				lcFoco="Text"+LTRIM(STR(bini))
			ENDIF	
			bini=bini+1	
			nd=nd+1
			IF nd>diafin
				EXIT
			ENDIF
		ENDDO
		nSumDia=0
		FOR EACH ocontrol IN this.Controls
			IF UPPER(ocontrol.baseclass)=="TEXTBOX"
				lcNum=CHRTRAN(ocontrol.name,CHRTRAN(ocontrol.Name,"1234567890",""),"")
				lnNum=VAL(lcnum)
				IF BETWEEN(lnNum,36,42)
					nSumDia=nSumdia+ocontrol.value
				ENDIF
					
			ENDIF
		ENDFOR
		WITH this
			.gmarco3.Visible=!EMPTY(nSumDia)
		*	.gmarco3.Visible=.t.
		*	obtop=IIF(.gmarco3.visible,.gmarco3.top+.gmarco3.Height,;
		*		.gmarco2.top+.gmarco2.Height)-1
		*
		*	.Shape3d1.Height=obTop+.gmarco3.Height-.Shape3d1.top+5
			.Height=.Shape3d1.Top+.Shape3d1.Height+1
			.Width=.Shape3d1.width+1
			IF xlFoco
				.&lcFoco..SetFocus	
			endif
		ENDWITH
		*thisform.cntins.pofechoy1.getEstado(this)
		
	ENDPROC

	PROCEDURE GotFocus
		WITH this.cntfe
			.glab1.FontBold=.t.
			.semaf1001.Visible=.t.
		ENDWITH
		
	ENDPROC

	PROCEDURE Init
		LPARAMETERS xnAno,xnmes
		local lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		This.AddProperty("objManak",null)
		this.objManak=NEWOBJECT("funmanak",lcRoot,"",.t.)
		with this
			.ano=xnAno
			.mes=xnMes
			dimension .ZenMes(12)
			.ZenMes[1] = "ENERO"
			.ZenMes[2] = "FEBRERO"
			.ZenMes[3] = "MARZO"
			.ZenMes[4] = "ABRIL"
			.ZenMes[5] = "MAYO"
			.ZenMes[6] = "JUNIO"
			.ZenMes[7] = "JULIO"
			.ZenMes[8] = "AGOSTO"
			.ZenMes[9] = "SEPTIEMBRE"
			.ZenMes[10] = "OCTUBRE"
			.ZenMes[11] = "NOVIEMBRE"
			.ZenMes[12] = "DICIEMBRE"
		
			Dimension .aDiasem(7)
			.aDiaSem[1]="Domingo"
			.aDiaSem[2]="Lunes"
			.aDiaSem[3]="Martes"
			.aDiaSem[4]="Miércoles"
			.aDiaSem[5]="Jueves"
			.aDiaSem[6]="Viernes"
			.aDiaSem[7]="Sábado"
		
			.dia=1
			.selperi=.ano*100+.mes
			.selmes=Proper(This.ZenMes[this.mes])
			.masdias=30
			.Shape3d1.Top=1
			.Shape3d1.Left=1
			.gmarco1.Top=.TExt1.Top
			.gmarco2.Top=.text29.Top
			.gmarco3.Top=.text36.Top
			.gmarco1.Left=.TExt1.Left
			.gmarco2.Left=.text29.Left
			.gmarco3.Left=.text36.Left	
			.CntFe.glab1.Caption=.Selmes+" de "+LTRIM(STR(.ano))
		ENDWITH
		WITH THIS.Cntfe.semaf1001
			.vISIBLE=.F.
			.IVERde.Visible=.T.
			.IROJO.VISIBLE=.F.
			.IAMARILLO.VISIBLE=.F.
		ENDWITH
		this.gmes(this.ano,this.mes)
		*ADDPROPERTY(_screen,"Fechasel",null)
		
		
		
		
		
		
		
		
	ENDPROC

	PROCEDURE LostFocus
		WITH this.cntfe
			.glab1.FontBold=.f.
			.semaf1001.Visible=.F.
		ENDWITH
		
	ENDPROC

	PROCEDURE objfollow
		LPARAMETERS xcObjeto , xnAdd
		************************************
		* Para un objeto "text1", si xnAdd=1 Devolvera "text2"
		* Para un Objeto "Text1", si xnAdd= -1, Devolvera "Text1"
		* --------------------------------------------------------
		LOCAL lcnum,lnNum
		IF VARTYPE(xcObjeto)#"C" OR empty(xcObjeto)
			RETURN ""
		ENDIF
		IF VARTYPE(xnAdd)#"N" OR empty(xnAdd)
			xnADd=1
		ENDIF
		lcNum=CHRTRAN(m.xcObjeto,CHRTRAN(m.xcObjeto,"1234567890",""),"")
		lnNum=VAL(m.lcNum)+m.xnAdd
		RETURN IIF(m.lnNum>0,STRTRAN(m.xcObjeto,m.lcnum)+LTRIM(STR(m.lnNum)),m.xcObjeto)
		
	ENDPROC

	PROCEDURE Text1.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text10.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text11.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text12.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text13.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text14.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text15.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text16.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text17.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text18.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text19.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text2.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text20.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text21.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text22.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text23.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text24.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text25.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text26.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text27.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text28.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text29.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text3.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text30.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text31.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text32.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text33.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text34.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text35.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text36.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text37.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text38.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text39.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text4.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text40.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text41.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text42.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text5.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text6.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text7.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text8.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

	PROCEDURE Text9.ProgrammaticChange
		this.Visible=!EMPTY(this.Value)
		
	ENDPROC

ENDDEFINE

DEFINE CLASS frmanual AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="CntIns" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Gmarco5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Gmarco1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Glab1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Gmarco2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Glab2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Gmarco3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Glab3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Gmarco4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Glab4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Gmarco6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Glab5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Check1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.cmgMeses" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CntIns.Pofechoy1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="TxFecha" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: genmanak
		*p: formcall
		*p: objfun
		*p: oriano
		*p: oridia
		*p: orimes
		*a: gacont[1,0]
	*</DefinedPropArrayMethod>

	BackColor = 184,201,197
	Caption = "Theodore Almanaque"
	DoCreate = .T.
	formcall = .F.
	Height = 250
	Icon = ..\graphics\fibona5.ico
	Left = 0
	MaxButton = .F.
	Name = "frmanual"
	objfun = .F.
	oriano = .F.
	oridia = .F.
	orimes = .F.
	ShowTips = .T.
	ShowWindow = 1
	Top = 0
	Width = 793

	ADD OBJECT 'CntIns' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 22, ;
		Left = 3, ;
		Name = "CntIns", ;
		Top = 97, ;
		Width = 760
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'CntIns.Check1' AS checkbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		DownPicture = ..\graphics\mnualmanaf.bmp, ;
		Height = 20, ;
		Left = 706, ;
		Name = "Check1", ;
		Picture = ..\graphics\mnualmanak.bmp, ;
		SpecialEffect = 0, ;
		Style = 1, ;
		ToolTipText = "Año Calendario", ;
		Top = 2, ;
		Value = .F., ;
		Width = 22
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'CntIns.cmgMeses' AS commandgroup WITH ;
		BackColor = 221,226,222, ;
		BorderColor = 114,136,141, ;
		BorderStyle = 1, ;
		ButtonCount = 2, ;
		Height = 21, ;
		Left = 665, ;
		Name = "cmgMeses", ;
		SpecialEffect = 1, ;
		Top = 1, ;
		Value = 1, ;
		Width = 40, ;
		Command1.BackColor = 149,177,171, ;
		Command1.Caption = "", ;
		Command1.DisabledPicture = ..\graphics\fle1132leftgn.bmp, ;
		Command1.Height = 16, ;
		Command1.Left = 3, ;
		Command1.Name = "cmdMesAnt", ;
		Command1.Picture = ..\graphics\fle1132leftg.bmp, ;
		Command1.SpecialEffect = 2, ;
		Command1.ToolTipText = "Año Anterior", ;
		Command1.Top = 3, ;
		Command1.Width = 17, ;
		Command2.BackColor = 149,177,171, ;
		Command2.Caption = "", ;
		Command2.DisabledPicture = ..\graphics\fle1132rigthgn.bmp, ;
		Command2.Height = 16, ;
		Command2.Left = 20, ;
		Command2.Name = "cmdMesSig", ;
		Command2.Picture = ..\graphics\fle1132rightg.bmp, ;
		Command2.SpecialEffect = 2, ;
		Command2.ToolTipText = "Año Siguiente", ;
		Command2.Top = 3, ;
		Command2.Width = 17
		*< END OBJECT: BaseClass="commandgroup" />

	ADD OBJECT 'CntIns.Glab1' AS glab WITH ;
		Caption = "[+]=Mes Siguente", ;
		FontBold = .T., ;
		Left = 67, ;
		Name = "Glab1", ;
		Top = 4
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntIns.Glab2' AS glab WITH ;
		Caption = "[-]=Mes Anterior", ;
		FontBold = .T., ;
		Left = 173, ;
		Name = "Glab2", ;
		Top = 4
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntIns.Glab3' AS glab WITH ;
		Caption = "[Enter]=Seleccionar", ;
		FontBold = .T., ;
		ForeColor = 0,64,128, ;
		Left = 273, ;
		Name = "Glab3", ;
		Top = 4
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntIns.Glab4' AS glab WITH ;
		Caption = "[DblClick]=Seleccionar", ;
		FontBold = .T., ;
		ForeColor = 0,64,128, ;
		Left = 388, ;
		Name = "Glab4", ;
		Top = 4
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntIns.Glab5' AS glab WITH ;
		Caption = "[PgDn] [PgUp]=Columnas", ;
		FontBold = .T., ;
		Left = 520, ;
		Name = "Glab5", ;
		Top = 4
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="label" />

	ADD OBJECT 'CntIns.Gmarco1' AS gmarco WITH ;
		Height = 21, ;
		Left = 63, ;
		Name = "Gmarco1", ;
		Top = 1, ;
		Width = 106
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntIns.Gmarco2' AS gmarco WITH ;
		Height = 21, ;
		Left = 168, ;
		Name = "Gmarco2", ;
		Top = 1, ;
		Width = 101
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntIns.Gmarco3' AS gmarco WITH ;
		Height = 21, ;
		Left = 268, ;
		Name = "Gmarco3", ;
		Top = 1, ;
		Width = 116
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntIns.Gmarco4' AS gmarco WITH ;
		Height = 21, ;
		Left = 383, ;
		Name = "Gmarco4", ;
		Top = 1, ;
		Width = 132
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntIns.Gmarco5' AS gmarco WITH ;
		Left = 63, ;
		Name = "Gmarco5", ;
		Top = 1
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntIns.Gmarco6' AS gmarco WITH ;
		Height = 21, ;
		Left = 514, ;
		Name = "Gmarco6", ;
		Top = 1, ;
		Width = 152
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="shape" />

	ADD OBJECT 'CntIns.Pofechoy1' AS pofechoy WITH ;
		Left = 1, ;
		Name = "Pofechoy1", ;
		Top = 1
		*< END OBJECT: ClassLib="mzmanak.vcx" BaseClass="textbox" />

	ADD OBJECT 'TxFecha' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 89,89,89, ;
		FontSize = 8, ;
		ForeColor = 81,81,81, ;
		Format = "D", ;
		Height = 21, ;
		Left = 110, ;
		Name = "TxFecha", ;
		ReadOnly = .T., ;
		SpecialEffect = 1, ;
		ToolTipText = "Hoy es", ;
		Top = 160, ;
		Visible = .F., ;
		Width = 63
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE Activate
		SYS(2002)
	ENDPROC

	PROCEDURE Deactivate
		SYS(2002,1)
	ENDPROC

	PROCEDURE Destroy
		UNBINDEVENTS(this)
		IF USED("curFeriados")
			SELECT curFeriados
			USE
		ENDIF
		this.FunManak1.SaveCust(thisform)
		this.RemoveObject("FunManak1")
		this.RemoveObject("Funsombra1")
		
		
	ENDPROC

	PROCEDURE genmanak
		LPARAMETERS xnAno,xnMes,xnDia
		LOCAL lnAno,lnMes,lnPeri,nTop,nLeft,nVert,nHoriz,nwid,nv,nh,;
			lngtop,lngLeft,lcRoot
		
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		
		thisform.Funmanak1.formublok(.f.)
		thisform.LockScreen=.t.
		lnAno=xnAno
		lnMes=xnMes
		lnPeri=xnAno*100+lnMes
		SYS(2002)
		STORE 1 TO nTop,lnGtop
		STORE 1 TO nLeft,lnGleft
		STORE .f. TO lSalto
		STORE 0 TO nWid
		lnMes=lnMes-1
		FOR i=1 TO 12
			lnMes=lnMes+1
			IF lnMes>12
				lnMes=1
				lnAno=lnAno+1
			endif
			lcName="cnt_Mk"+LTRIM(STR(i))
			IF PEMSTATUS(thisform,lcName,5)
				thisform.RemoveObject(lcName)
			endif
			IF !PEMSTATUS(thisform,lcName,5)
				Thisform.NewObject(lcName,"CntManak",lcRoot,"",lnAno,lnMes)
			ENDIF
		
			WITH thisform
				.Gacont[i,1]=this.FunManak1.gNombreMes(lnMes,.t.,.f.)+" "+LTRIM(STR(lnAno))
				.Gacont[i,2]=lnAno*100+lnMes
				.gacont[i,3]=lcName
			ENDWITH
			
			WITH thisform.&lcName
				nWid=.Width
				.Top=nTop
				.Left=nLeft
				nleft=nLeft+.Width-1
				IF MOD(i,4)=0
					nLeft=lngLeft
					nTop=nTop+.Height-1
				ENDIF
			ENDWITH
			
		
		NEXT
		STORE 0 TO nVert,nHoriz,nv,nh
		FOR EACH ocontrol IN thisform.Controls
		*!*		IF UPPER(ocontrol.baseclass)=="CONTAINER"
		*!*			IF UPPER(ocontrol.name)#"CNTINS"
			IF ocontrol.class="Cntmanak"
				ocontrol.visible=.t.
				nv=ocontrol.top+oControl.Height
				nh=ocontrol.left+oControl.Width
				IF nv>nVert
					nVert=nv
				ENDIF
				IF nh>nHoriz
					nHoriz=nh
				endif
				FOR EACH objin IN ocontrol.controls
					IF UPPER(objIn.baseclass)=="TEXTBOX"
						objIn.selectonentry=.t.
						BINDEVENT(objIn,"KeyPress",oControl,"bindgo")
						BINDEVENT(objIn,"Gotfocus",oControl,"bindfo")
						BINDEVENT(objIn,"DblClick",ocontrol,"bindDbl")
						BINDEVENT(objIn,"LostFocus",ocontrol,"BindLost")
					ENDIF
				ENDFOR
			ENDIF
		ENDFOR
		WITH thisform
			.cntIns.top=nvert
			.CntIns.left=lnGleft
			.CntIns.Width=nhoriz-lnGleft-1
			.CntIns.Gmarco5.width=.Cntins.width-1
			.Width=nhoriz+lngLeft
			.Height=.CntIns.top+.CntIns.Height+lnGleft
		ENDWITH
		this.funsombra1.getBind(thisform,.t.)
		thisform.LockScreen= .F.
		*Thisform.Funmanak1.formublok(.t.)
		nas=ASCAN(thisform.gacont,lnPeri)
		lcCont=IIF(nas#0,thisform.gacont(nas+1),"cnt_Mk1")
		IF PEMSTATUS(thisform,lcCont,5)
			lobj=thisform.&lcCont
			WITH lobj
				*.Dia=DAY(DATE())
				.dia=xndia
				.gmes(lobj.ano,lobj.mes,.t.)
			ENDWITH
		ENDIF
		thisform.Funmanak1.formublok(.t.)
	ENDPROC

	PROCEDURE Init
		LPARAMETERS xnAno,xnMes,xoObjeto,xnWindowType
		local lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")		
		this.NewObject("Funsombra1","FunSombra",lcRoot)
		this.NewObject("FunManak1","FunManak",lcRoot)
		this.funmanak1.genFeriados()
		
		IF VARTYPE(xnWindowType)#"N"
			xnWindowType=0
		ENDIF
		
		IF VARTYPE(xoObjeto)="O"
			thisform.formcall=xoObjeto
			dfe=EVL(xoObjeto.value,DATE())
			xnAno=EVL(xnAno,YEAR(dfe))
			xnMes=EVL(xnMes,MONTH(dfe))
			xnDia=DAY(dfe)
		ELSE
			xnDia=1
			IF VARTYPE(xnAno)#"N".or.empty(xnAno)
				xnAno=YEAR(DATE())
				xnMes=MONTH(DATE())
				xnDia=DAY(DATE())
			ENDIF
			IF VARTYPE(xnmes)#"N" .or. EMPTY(xnMes)
				xnMes=MONTH(DATE())
				xnDia=DAY(DATE())
			ENDIF
		ENDIF
		
		This.FunManak1.REadCust(thisform)
		with thisform
			.WindowType=xnWindowType
			.Minbutton=IIF(xnWindowType=0,.t.,.f.)
			.oriAno=xnAno
			.oriMes=xnMes
			.oridia=xnDia
			DIMENSION .gacont(12,3)
		ENDWITH
		this.cntIns.pofechoy1.Value=DATE()
		thisform.genmanak(xnAno,xnMes,xnDia)	
		
		
		
			
		
	ENDPROC

	PROCEDURE Load
		ADDPROPERTY(_screen,"Fechasel",null)
		thisform.formcall=null
		
		
		
		
	ENDPROC

	PROCEDURE Unload
		SYS(2002,1)
		
		IF !ISNULL(thisform.formcall)
			IF !ISNULL(_screen.fechasel)
				thisform.formcall.value=_Screen.Fechasel
			ENDIF
			
		ENDIF
		
	ENDPROC

	PROCEDURE CntIns.Check1.Click
		LOCAL lnAno,lnmes,lnDia
		IF this.Value
			lnAno=Thisform.Cnt_mk1.Ano
			lnMes=1
			lnDia=1
			this.ToolTipText="Volver al inicial"
		ELSE
			lnAno=Thisform.oriano
			lnMes=thisform.orimes
			lnDia=thisform.oridia
			this.ToolTipText="Año Calendario"
		ENDIF
		Thisform.genmanak(lnAno,lnMes,lndia)
	ENDPROC

	PROCEDURE CntIns.cmgMeses.Click
		LOCAL lnAno,lnMes,lnDia
		DO CASE 
			CASE this.Value=1
				WITH thisform.Cnt_Mk1
					lnAno=.Ano
					lnMes=.Mes
					lnDia=.Dia
				ENDWITH
				LnAno=lnAno-1
				*lnmes=lnMes+1
		
				Veriday=DAY(thisform.FunManak1.Findemes(lnAno,lnMes))
				IF lnDia>Veriday
					lnDia=Veriday
				ENDIF
				Thisform.genmanak(lnAno,lnMes,lndia)
				
			CASE this.Value=2
				
				WITH thisform.Cnt_Mk12
					lnAno=.Ano
					lnMes=.Mes
					lnDia=.Dia
				ENDWITH
				lnmes=lnMes+1
				IF lnMes>12
					lnMes=1
					lnAno=lnAno+1
				ENDIF
				Veriday=DAY(thisform.FunManak1.Findemes(lnAno,lnMes))
				IF lnDia>Veriday
					lnDia=Veriday
				ENDIF
				Thisform.genmanak(lnAno,lnMes,lndia)
		
		ENDCASE
		
			
	ENDPROC

	PROCEDURE TxFecha.Click
		lnPeri=VAL(LEFT(DTOS(this.Value),6))
		xnDia=DAY(this.Value)
		nas=ASCAN(thisform.gacont,lnPeri)
		*lcCont=IIF(nas#0,thisform.gacont(nas+1),"cnt_Mk1")
		IF nas#0
			lcCont=thisform.gaCont(nas+1)
			IF PEMSTATUS(thisform,lcCont,5)
				lobj=thisform.&lcCont
				WITH lobj
					*.Dia=DAY(DATE())
					.dia=xndia
					.gmes(lobj.ano,lobj.mes,.t.)
				ENDWITH
			ENDIF
		ELSE
			lnAno=YEAR(DATE())
			lnMes=MONTH(DATE())
			lnDia=DAY(DATE())
			thisform.Cnt_Mk1.dia=DAY(DATE())
			Thisform.genmanak(lnAno,lnMes,lndia)
		
		
		ENDIF
		
	ENDPROC

	PROCEDURE TxFecha.ProgrammaticChange
		LOCAL objParent
		objParent=this.Parent.Parent
		this.Visible=!EMPTY(this.Value)
		_Screen.FEchasel=this.Value
		*objParent.cnthoy1.getestado()
		
		
		
		
		
	ENDPROC

ENDDEFINE

DEFINE CLASS frmcalc AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Check1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Check2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Check3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CmCalc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Spinner1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: dcae
		*m: detime
		*m: dplazo
		*p: ano
		*p: dia
		*p: dia1
		*p: dia2
		*p: diacae
		*p: diacal
		*p: masdias
		*p: mes
		*p: objfun
		*p: selmes
		*p: selperi
		*a: adiasem[1,0]
		*a: zenmes[1,0]
	*</DefinedPropArrayMethod>

	BackColor = 184,201,197
	Caption = "Cálculos de Fecha"
	DoCreate = .T.
	Height = 286
	Left = 0
	MaxButton = .F.
	MinButton = .T.
	Name = "frmcalc"
	objfun = .F.
	ShowTips = .T.
	ShowWindow = 1
	Top = 0
	Width = 449

	ADD OBJECT 'Check1' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Qué día cae?", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 11, ;
		Name = "Check1", ;
		Top = 60, ;
		Value = .F., ;
		Width = 82
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'Check2' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Plazo", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 11, ;
		Name = "Check2", ;
		Top = 10, ;
		Value = .F., ;
		Width = 44
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'Check3' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Cálculo de días transcurridos", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 12, ;
		Name = "Check3", ;
		Top = 110, ;
		Value = .F., ;
		Width = 159
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'CmCalc' AS commandbutton WITH ;
		Caption = "", ;
		DisabledPicture = ..\graphics\flidereblu1513n.bmp, ;
		Height = 19, ;
		Left = 249, ;
		Name = "CmCalc", ;
		Picture = ..\graphics\flidereblu1513.bmp, ;
		TabIndex = 7, ;
		ToolTipText = "Generar la serie.", ;
		Top = 128, ;
		Visible = .F., ;
		Width = 21
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Label1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Más:", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 197, ;
		Name = "Label1", ;
		TabIndex = 14, ;
		Top = 11, ;
		Width = 25
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label10' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Hasta:", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 137, ;
		Name = "Label10", ;
		TabIndex = 17, ;
		Top = 131, ;
		Width = 33
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label12' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Resultado", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 13, ;
		Name = "Label12", ;
		TabIndex = 23, ;
		Top = 30, ;
		Width = 50
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label13' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Ultimo día", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 13, ;
		Name = "Label13", ;
		TabIndex = 23, ;
		Top = 190, ;
		Width = 47
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label14' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Primer día", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 13, ;
		Name = "Label14", ;
		TabIndex = 23, ;
		Top = 171, ;
		Width = 49
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Fecha:", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 161, ;
		Name = "Label2", ;
		TabIndex = 10, ;
		Top = 60, ;
		Width = 35
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "El día es", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 15, ;
		Name = "Label3", ;
		TabIndex = 11, ;
		Top = 80, ;
		Width = 42
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Días", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 288, ;
		Name = "Label4", ;
		TabIndex = 19, ;
		Top = 11, ;
		Width = 23
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Fecha:", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 78, ;
		Name = "Label6", ;
		TabIndex = 23, ;
		Top = 11, ;
		Width = 35
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label7' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Días:", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 12, ;
		Name = "Label7", ;
		TabIndex = 16, ;
		Top = 151, ;
		Width = 26
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label9' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Desde:", ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 12, ;
		Name = "Label9", ;
		TabIndex = 18, ;
		Top = 131, ;
		Width = 36
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Shape1' AS shape WITH ;
		BackColor = 221,226,222, ;
		Height = 50, ;
		Left = 3, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 53, ;
		Width = 281
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape10' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape10", ;
		Top = 127, ;
		Width = 57
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape11' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 126, ;
		Name = "Shape11", ;
		Top = 127, ;
		Width = 153
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape12' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape12", ;
		Top = 27, ;
		Width = 75
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape13' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape13", ;
		Top = 57, ;
		Width = 183
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape14' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape14", ;
		Top = 77, ;
		Width = 70
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape15' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape15", ;
		Top = 7, ;
		Width = 75
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape16' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape16", ;
		Top = 187, ;
		Width = 75
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape17' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape17", ;
		Top = 167, ;
		Width = 75
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape2' AS shape WITH ;
		BackColor = 221,226,222, ;
		Height = 50, ;
		Left = 3, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 3, ;
		Width = 322
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape3' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape3", ;
		Top = 147, ;
		Width = 37
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape4' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 66, ;
		Name = "Shape4", ;
		Top = 7, ;
		Width = 63
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape5' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 186, ;
		Name = "Shape5", ;
		Top = 7, ;
		Width = 40
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape6' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 137, ;
		Name = "Shape6", ;
		Top = 57, ;
		Width = 79
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape7' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 7, ;
		Name = "Shape7", ;
		Top = 107, ;
		Width = 272
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape8' AS shape WITH ;
		BackColor = 231,237,234, ;
		BorderColor = 114,136,141, ;
		Height = 21, ;
		Left = 284, ;
		Name = "Shape8", ;
		Top = 7, ;
		Width = 36
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape9' AS shape WITH ;
		BackColor = 221,226,222, ;
		Height = 110, ;
		Left = 3, ;
		Name = "Shape9", ;
		SpecialEffect = 0, ;
		Top = 103, ;
		Width = 281
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Spinner1' AS spinner WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		InputMask = "99,999", ;
		Left = 225, ;
		Name = "Spinner1", ;
		SpecialEffect = 1, ;
		TabIndex = 4, ;
		ToolTipText = "Cantidad de días.", ;
		Top = 7, ;
		Width = 60
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'Text1' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "D", ;
		Height = 21, ;
		Left = 215, ;
		Name = "Text1", ;
		SpecialEffect = 1, ;
		TabIndex = 1, ;
		Top = 57, ;
		Width = 64
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text10' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 76, ;
		Name = "Text10", ;
		SpecialEffect = 1, ;
		TabIndex = 22, ;
		ToolTipText = "Día resultante", ;
		Top = 167, ;
		Width = 203
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text11' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 76, ;
		Name = "Text11", ;
		SpecialEffect = 1, ;
		TabIndex = 22, ;
		ToolTipText = "Día resultante", ;
		Top = 187, ;
		Width = 203
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text2' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 76, ;
		Name = "Text2", ;
		SpecialEffect = 1, ;
		TabIndex = 12, ;
		Top = 77, ;
		Width = 203
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text3' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "D", ;
		Height = 21, ;
		Left = 63, ;
		Name = "Text3", ;
		SpecialEffect = 1, ;
		TabIndex = 5, ;
		Top = 127, ;
		Width = 64
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text4' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "D", ;
		Height = 21, ;
		Left = 179, ;
		Name = "Text4", ;
		SpecialEffect = 1, ;
		TabIndex = 6, ;
		Top = 127, ;
		Width = 64
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text5' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 106, ;
		Name = "Text5", ;
		SpecialEffect = 1, ;
		TabIndex = 13, ;
		Top = 147, ;
		Width = 173
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text6' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "D", ;
		Height = 21, ;
		Left = 66, ;
		Name = "Text6", ;
		SpecialEffect = 1, ;
		TabIndex = 20, ;
		ToolTipText = "Fecha resultante", ;
		Top = 27, ;
		Value = (Ctod("")), ;
		Width = 62
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text7' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 127, ;
		Name = "Text7", ;
		SpecialEffect = 1, ;
		TabIndex = 22, ;
		ToolTipText = "Día resultante", ;
		Top = 27, ;
		Width = 193
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text8' AS textbox WITH ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "D", ;
		Height = 21, ;
		Left = 127, ;
		Name = "Text8", ;
		SpecialEffect = 1, ;
		TabIndex = 3, ;
		Top = 7, ;
		Width = 64
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text9' AS textbox WITH ;
		Alignment = 3, ;
		BorderColor = 114,136,141, ;
		DisabledBackColor = 242,247,243, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Format = "Z", ;
		Height = 21, ;
		InputMask = "99,999,999", ;
		Left = 43, ;
		Name = "Text9", ;
		SpecialEffect = 1, ;
		TabIndex = 21, ;
		ToolTipText = "Fecha resultante", ;
		Top = 147, ;
		Value = 0, ;
		Width = 64
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE dcae
		lparameters xdia
		tHISFORM.teXT2.VALUE=iif(empty(xdia),"",thisform.funmanak1.TelmeDia(xdia))
	ENDPROC

	PROCEDURE Destroy
		LOCAL objEmpty
		objEmpty=NEWOBJECT("EMPTY")
		ADDPROPERTY(objEmpty,"gaDesVal[8,2]",null)
		WITH objEmpty
			.gaDesval[1,1]="DIA1"
			.gaDesval[1,2]=this.dia1
			.gaDesval[2,1]="DIA2"
			.gaDesval[2,2]=this.dia2
			.gaDesval[3,1]="DIACAE"
			.gaDesval[3,2]=this.diacae
			.gaDesval[4,1]="DIACAL"
			.gaDesval[4,2]=this.diacal
			.gaDesval[5,1]="MASDIAS"
			.gaDesval[5,2]=this.masdias
			.gaDesval[6,1]="*CHECK1"
			.gaDesval[6,2]=this.CHECk1.Value
			.gaDesval[7,1]="*CHECK2"
			.gaDesval[7,2]=this.CHECk2.Value	
			.gaDesval[8,1]="*CHECK3"
			.gaDesval[8,2]=this.CHECk3.Value	
		ENDWITH
		
		this.funmanak1.savecust(thisform,objEmpty)
		this.RemoveObject("FunManak1")
		objEmpty=null
		
		
		
		
	ENDPROC

	PROCEDURE detime
		lparameters xlinit
		LOCAL dia1,dia2,objEdad
		WITH THISFORM
			DIA1=.DIA1
			DIA2=.DIA2
			.Text5.Value=""
			.Text9.Value=""
			.Text10.Value=iif(empty(dia1),"",.funmanak1.TelmeDia(dia1))
			.Text11.Value=iif(empty(dia2),"",.funmanak1.TelmeDia(dia2))
		ENDWITH
		IF EMPTY(dia1).or.empty(dia2)
			if xlInit
				return
			endif
			MESSAGEBOX("Ingrese el rango de fechas",0,PROGRAM())
			thisform.text3.setfocus
			return
		endif
		thisform.funmanak1.dosdias(@dia1,@dia2)
		objEdad=thisform.funmanak1.Calcedad(dia1,dia2)
		with thisform
			.dia1=dia1
			.dia2=dia2
			.text3.refresh
			.text4.refresh
			.text9.value=dia2-dia1
			.text5.value=objEdad.tiempo
		ENDWITH
		objEdad=null
	ENDPROC

	PROCEDURE dplazo
		lparameters xdia,xnsum
		dfe=iif(empty(xdia),Ctod(""),xdia+xnSum)
		with Thisform
			.text6.value=dfe
			.teXT7.VALUE=iif(empty(dfe),"",.funmanak1.TelmeDia(dfe))
		endwith
		
		
		
	ENDPROC

	PROCEDURE Init
		parameters xnWin
		local lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		if Vartype(xnWin)#"N"
			xnwin=0
		ENDIF
		
		thisform.NewObject("cmCerrar1","cmCerrar",lcRoot)
		thisform.NewObject("funmanak1","funmanak",lcRoot)
		this.funmanak1.readcust(thisform,80,150)
		*!*	xntop=80
		*!*	xnleft=150
		*!*	rautopos(thisform.name,@xnTop,@xnleft)
		with thisform
			.WindowType=xnWin
			.MInButton=iif(xnWin=0,.t.,.f.)
			.text1.ControlSource='thisform.diacae'
			.Text8.ControlSource='thisform.diacal'
			.text3.controlSource='thisform.dia1'
			.text4.ControlSource='thisform.dia2'
			.ano=Year(date())
			.mes=Month(date())
			.Dia=Day(date())
			.Selperi=Thisform.ano*100+thisform.mes
			.Selmes=PROPER(Thisform.ZenMes[Thisform.mes])
			.spinner1.ControlSource='Thisform.Masdias'
			.dcae(.diacae)
			.dPlazo(.diacal,.MasDias)
			.detime(.t.)
			.Width=.shape2.Left*2+.Shape2.Width
			.Height=.Shape9.top+.Shape9.Height+6
			.CmCerrar1.Top=.height-28
			.CmCerrar1.Left=.width-28
			.CmCerrar1.visible=.t.
		endwith
	ENDPROC

	PROCEDURE Load
		with thisform
			.diacae=date()
			.Diacal=date()
			.DIA1=ctod("")
			.DIA2=ctod("")
			.Masdias=30
			dimension .ZenMes(12)
			.ZenMes[1] = "ENERO"
			.ZenMes[2] = "FEBRERO"
			.ZenMes[3] = "MARZO"
			.ZenMes[4] = "ABRIL"
			.ZenMes[5] = "MAYO"
			.ZenMes[6] = "JUNIO"
			.ZenMes[7] = "JULIO"
			.ZenMes[8] = "AGOSTO"
			.ZenMes[9] = "SEPTIEMBRE"
			.ZenMes[10] = "OCTUBRE"
			.ZenMes[11] = "NOVIEMBRE"
			.ZenMes[12] = "DICIEMBRE"
		
			Dimension .aDiasem(7)
			.aDiaSem[1]="Domingo"
			.aDiaSem[2]="Lunes"
			.aDiaSem[3]="Martes"
			.aDiaSem[4]="Miercoles"
			.aDiaSem[5]="Jueves"
			.aDiaSem[6]="Viernes"
			.aDiaSem[7]="Sabado"
		endwith
	ENDPROC

	PROCEDURE Check1.Click
		with thisform
			.text1.Enabled=this.value
			.label2.Enabled=this.value
			.label3.Enabled=this.value	
		endwith
		thisform.dcae(thisform.diacae)
		if this.value
			thisform.text1.Setfocus
		endif
		
	ENDPROC

	PROCEDURE Check1.ProgrammaticChange
		with thisform
			.text1.Enabled=this.value
			.label2.Enabled=this.value
			.label3.Enabled=this.value	
		endwith
		thisform.dcae(thisform.diacae)
	ENDPROC

	PROCEDURE Check2.Click
		with thisform
			.text8.Enabled=this.value
			.Spinner1.Enabled=this.value
			.label6.Enabled=this.value
			.label4.Enabled=this.value
			.label1.Enabled=this.value
			.label12.Enabled=this.value
			.dPlazo(.diacal,.Masdias)	
			if this.value
				.text8.Setfocus
			endif
		endwith
		
	ENDPROC

	PROCEDURE Check2.ProgrammaticChange
		with thisform
			.text8.Enabled=this.value
			.Spinner1.Enabled=this.value
			.label6.Enabled=this.value
			.label4.Enabled=this.value
			.label1.Enabled=this.value
			.label12.Enabled=this.value
			.dPlazo(.diacal,.Masdias)	
		endwith
	ENDPROC

	PROCEDURE Check3.Click
		with thisform
			.text3.Enabled=this.value
			.Text4.Enabled=this.value
			.label7.Enabled=this.value
			.label9.Enabled=this.value
			.label10.Enabled=this.value	
			.label13.Enabled=this.value
			.label14.Enabled=this.value	
			.CmCalc.Visible=this.value
			.detime(.t.)
			if this.value
				.text3.Setfocus
			endif
		endwith
	ENDPROC

	PROCEDURE Check3.ProgrammaticChange
		with thisform
			.text3.Enabled=this.value
			.Text4.Enabled=this.value
			.label7.Enabled=this.value
			.label9.Enabled=this.value
			.label10.Enabled=this.value	
			.label13.Enabled=this.value
			.label14.Enabled=this.value	
			.CmCalc.Visible=this.value
		*	.detime(.t.)
		endwith
	ENDPROC

	PROCEDURE CmCalc.Click
		thisform.detime()
		
		*TelMedad(Fe1,Fe2,lShort,lfulShort,xcFulsFil,xnCalfe)
		
	ENDPROC

	PROCEDURE CmCalc.GotFocus
		thisform.funmanak1.PutRaya(this)
	ENDPROC

	PROCEDURE CmCalc.LostFocus
		Thisform.funmanak1.PutRaya()
	ENDPROC

	PROCEDURE Spinner1.DownClick
		Thisform.dPlazo(thisform.diacal,this.value)
		
	ENDPROC

	PROCEDURE Spinner1.InteractiveChange
		
		
	ENDPROC

	PROCEDURE Spinner1.LostFocus
		Thisform.dPlazo(thisform.diacal,this.value)
	ENDPROC

	PROCEDURE Spinner1.UpClick
		Thisform.dPlazo(thisform.diacal,this.value)
	ENDPROC

	PROCEDURE Text1.LostFocus
		Thisform.dcae(this.value)
	ENDPROC

	PROCEDURE Text10.ProgrammaticChange
		nColor=iif(thisform.Check3.Value,0,128)
		This.DisabledForeColor=Rgb(nColor,nColor,nColor)
	ENDPROC

	PROCEDURE Text11.ProgrammaticChange
		nColor=iif(thisform.Check3.Value,0,128)
		This.DisabledForeColor=Rgb(nColor,nColor,nColor)
	ENDPROC

	PROCEDURE Text2.ProgrammaticChange
		nColor=iif(thisform.Check1.Value,0,128)
		This.DisabledForeColor=Rgb(nColor,nColor,nColor)
	ENDPROC

	PROCEDURE Text3.LostFocus
		dia1=this.value
		thisform.Text10.Value=iif(empty(dia1),"",thisform.Funmanak1.TelMedia(dia1))
		
	ENDPROC

	PROCEDURE Text3.Valid
		thisform.CmCalc.Enabled=!empty(this.value)
	ENDPROC

	PROCEDURE Text4.LostFocus
		dia2=this.value
		thisform.Text11.Value=iif(empty(dia2),"",thisform.funmanak1.TelMedia(dia2))
	ENDPROC

	PROCEDURE Text4.Valid
		thisform.CmCalc.Enabled=!empty(this.value)
	ENDPROC

	PROCEDURE Text5.ProgrammaticChange
		nColor=iif(thisform.Check3.Value,0,128)
		This.DisabledForeColor=Rgb(nColor,nColor,nColor)
	ENDPROC

	PROCEDURE Text6.Click
		
		
	ENDPROC

	PROCEDURE Text6.ProgrammaticChange
		nColor=iif(thisform.Check2.Value,0,128)
		This.DisabledForeColor=Rgb(nColor,nColor,nColor)	
	ENDPROC

	PROCEDURE Text7.ProgrammaticChange
		nColor=iif(thisform.Check2.Value,0,128)
		This.DisabledForeColor=Rgb(nColor,nColor,nColor)
	ENDPROC

	PROCEDURE Text8.Valid
		thisform.Spinner1.Enabled=!empty(this.value)
		if empty(this.value)
			thisform.text6.value=""
			thisform.text7.value=""
		endif
	ENDPROC

	PROCEDURE Text9.ProgrammaticChange
		nColor=iif(thisform.Check3.Value,0,128)
		This.DisabledForeColor=Rgb(nColor,nColor,nColor)
	ENDPROC

ENDDEFINE

DEFINE CLASS frmmanak AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*m: tryforma
		*p: formcall
		*p: frmmanak
		*p: objfun
	*</DefinedPropArrayMethod>

	AlwaysOnTop = .T.
	BackColor = 184,201,197
	Caption = "Theodore Almanaque"
	DoCreate = .T.
	formcall = .F.
	frmmanak = null
	Height = 250
	Icon = ..\graphics\fibona5.ico
	Left = 0
	MaxButton = .F.
	Name = "frmmanak"
	objfun = .F.
	ShowTips = .T.
	ShowWindow = 1
	Top = 0
	Width = 277
	
	PROCEDURE Activate
		SYS(2002)
	ENDPROC

	PROCEDURE Deactivate
		SYS(2002,1)
	ENDPROC

	PROCEDURE Destroy
		UNBINDEVENTS(this)
		this.funmanak1.SaveCust(thisform)
		this.RemoveObject("CntAlma1")
		this.RemoveObject("CmCerrar1")
		this.RemoveObject("Funsombra1")
		this.RemoveObject("FunManak1")
		
	ENDPROC

	PROCEDURE Init
		LPARAMETERS xnAno,xnMes,xnDia,xnWint_objeto,xnWindowType
		LOCAL dFEcha,lcRoot
		
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		IF VARTYPE(xnAno)#"N".or.empty(xnAno)
			xnAno=YEAR(DATE())
		ENDIF
		IF VARTYPE(xnMes)#"N".or.empty(xnmes)
			xnmes=MONTH(DATE())
		ENDIF
		IF VARTYPE(xnDia)#"N".or.empty(xnDia)
			xnDia=DAY(DATE())
		ENDIF
		dFecha=DATE(xnAno,xnmes,xndia)
		IF VARTYPE(xnWindowType)#"N"
			xnWindowtype=0
		ENDIF
		this.NewObject("CntAlma1","CntAlma",lcRoot)
		this.NewObject("CmCerrar1","CmCerrar",lcRoot)
		this.NewObject("Funsombra1","FunSombra",lcRoot)
		this.NewObject("FunManak1","FunManak",lcRoot)
		this.Funmanak1.genFeriados()
		DO case
			case VARTYPE(xnWint_objeto)="O"
				thisform.formcall=xnWint_objeto
				IF !EMPTY(thisform.formcall.value)
					dFEcha=thisform.formcall.value
				ENDIF
				
			CASE VARTYPE(xnWint_objeto)="N"
				xnWindowType=xnWint_objeto
		endcase
		WITH thisform.Cntalma1
			.ano=YEAR(dfecha)
			.mes=MONTH(dfecha)
			.dia=DAY(dfecha)
			.Selmes=PROPER(.ZenMes[.mes])
		*!*		.Combo1.refresh
		*!*		.Spinner2.refresh
		*!*		.Spinner3.refresh
			.top=1
			.left=1
			.visible=.t.
		ENDWITH
		this.funmanak1.readCust(thisform)
		
		with thisform
			.windowtype=xnWindowType
			.MinButton=IIF(xnWindowType=0,.t.,.f.)
			.cmCerrar1.visible=.t.
		ENDWITH
		WITH thisform.Cntalma1
			.Spinner2.ControlSource='Thisform.cntAlma1.ano'
			.Combo1.ControlSource='thisform.CntAlma1.Selmes'
			
		ENDWITH
		FOR EACH ocontrol IN thisform.cntalma1.Controls
			IF UPPER(ocontrol.baseclass)=="TEXTBOX"
				ocontrol.selectonentry=.t.
				BINDEVENT(oControl,"KeyPress",thisform.cntalma1,"bindgo")
				BINDEVENT(ocontrol,"Gotfocus",thisform.cntalma1,"bindfo")
				BINDEVENT(ocontrol,"DblClick",thisform.cntalma1,"bindDbl")
				BINDEVENT(ocontrol,"LostFocus",thisform.cntAlma1,"BindLost")
			ENDIF
		ENDFOR
		thisform.Cntalma1.gmes(thisform.cntalma1.ano,thisform.cntalma1.mes,.t.)
		thisform.tryForma()
		
		
		
	ENDPROC

	PROCEDURE Load
		this.formcall=null
		*!*	this.objFun=NEWOBJECT("funmanak","mzmanak","",.t.)
		*!*	this.objfun.genFeriados()
		
		
		
		
		
		
		
	ENDPROC

	PROCEDURE QueryUnload
		_screen.fechasel=null
		
	ENDPROC

	PROCEDURE tryforma
		thisform.funmanak1.gstandar("CntAlma1")
	ENDPROC

	PROCEDURE Unload
		
		IF USED("curFeriados")
			SELECT curFeriados
			USE
		ENDIF
		IF !ISNULL(thisform.formcall)
			IF !ISNULL(_screen.Fechasel)
				THISFORM.FORMCALL.VALUE=_SCREEN.FECHASEL
			ELSE
				thisform.formcall.SelStart=0
			ENDIF
			thisform.formcall.pedido=.f.
		ENDIF
		IF THISFORM.WindowType= 1
			RETURN _SCREEN.FECHASEL
		ENDIF
		
			
	ENDPROC

ENDDEFINE

DEFINE CLASS funmanak AS custom 
 	*< CLASSDATA: Baseclass="custom" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*m: calcedad
		*m: detmask
		*m: diasem
		*m: dosdias
		*m: feriafix		&& Días Feriados Fijos
		*m: findemes
		*m: formublok
		*m: genferiados
		*m: getfopen
		*m: getmanak
		*m: getvaltag
		*m: gnombremes
		*m: gstandar
		*m: motherday
		*m: pascuale		&& Determina el domingo de pascua de un año.
		*m: putraya
		*m: puttag
		*m: qualifer2
		*m: readcust
		*m: savecust
		*m: showerror
		*m: teldecim
		*m: telmedia
		*m: thcentrar
		*p: objfocus
		*a: gaferia[1,0]
	*</DefinedPropArrayMethod>

	Name = "funmanak"
	objfocus = null
	Width = 30
	
	PROCEDURE calcedad
		LPARAMETERS xDia1,xDia2
		*xDia1 es la fecha inferior
		*xDia2 es la fecha superior o Date()
		xDia2=EVL(xdia2,DATE())
		LOCAL lnAnos,lnMeses,lnDias,lnAno2,lnMes2,lnDia1,lnDia2,;
			objEmpty,lcano,lcmes,lcdia
		
		lnAnos =Year(xDia2)-Year(xDia1) - 1
		lnMeses =12-Month(xDia1) + Month(xDia2) - 1
		
		do case
			case Day(xDia1) = Day(xDia2)
				lnMeses = lnMeses+1
			case Day(xDia2) > Day(xDia1)
				lnMeses = lnMeses + 1
			case Day(xDia2) < Day(xDia1)
				*	lnMeses = lnMeses
		endcase
		if lnMeses >= 12
			lnMeses =lnMeses - 12
			lnAnos =lnAnos + 1
		endif
		
		if Day(xDia1)=Day(xDia2)
			lnDias =0
		else
			lnDia1 =Day(xDia1)
			lnDia2 =Day(xDia2)
			if Day(xDia2) > Day(xDia1)
				lnDias =Day(xDia2)-Day(xDia1)
			else
				lnMes2 =month(xDia2)-1
				lnAno2 =Year(xDia2)
				if lnMes2 = 0
					lnMes2 =12
					lnAno2 =lnAno2-1
				endif
				lnDias =lnDia2 + DAY(Gomonth( Date( lnAno2 , lnMes2, 1) , 1) - 1) - lnDia1
			endif
		endif
		lcano =iif(lnAnos>1," Años "," Año ")
		lcmes =iif(lnMeses>1," Meses "," Mes ")
		lcdia =iif(lnDias>1," Días "," Día ")
		objEmpty=NEWOBJECT("Empty")
		ADDPROPERTY(objEmpty,"Tiempo",transform(lnAnos)+lcano+transform(lnMeses)+lcmes+transform(lnDias)+lcdia)
		ADDPROPERTY(objEmpty,"Años",lnAnos)
		ADDPROPERTY(objEmpty,"Meses",lnMeses)
		ADDPROPERTY(objEmpty,"Dias",lnDias)
		REturn objEmpty
		
	ENDPROC

	PROCEDURE detmask
		lparameters nAncho,nDecimal,xrancho,xnLim
		********************************
		* Determina la composición de una
		* máscara de formato numérico
		* xRancho se utiliza para devolver la 
		* cantidad de caracteres del formato
		* p.e.:
		* lnformaLen=0
		* This.DetMask(12,2,@LnFormaLen)
		* ?lnFormaLen
		********************************
		LOCAL cFormato,i_,nResto,nRep,nlen,cdec
		if vartype(xnLim)#"N".or.Empty(xnLim)
			xnLim=14
		endif
		if nAncho>xnLim
			nAncho=xnLim
		endif
		cFormato=""
		xRancho=0
		if nDecimal>0
			wAncho=nAncho-(nDecimal+1)
		else
			wAncho=nAncho
		endif
		
		nResto= Mod(wAncho,3)
		if nREsto=0
			nrep=wAncho/3
			*xCar=Repli("9",nrep)
			For i_=1 to nRep
				if i_<nRep
					cFormato=cFormato+"999,"
				else
					cFormato=cFormato+"999"
				endif
			next
		else
			wAncho=wAncho-nResto
			nrep=wAncho/3
			cFormato=Repli("9",nResto)+","
			For i_=1 to nRep
				if i_<nRep
					cFormato=cFormato+"999,"
				else
					cFormato=cFormato+"999"
				endif
			next
		endif
		nLen=Len(cFormato)
		if Substr(cFormato,nlen,1)=","
			cFormato=Substr(cFormato,1,nlen-1)
		endif
		if nDecimal>0
			cDec=Repli("9",nDEcimal)
			cFormato=cFormato+"."+cDec
		endif
		xRancho=Len(cFormato)
		return cFormato
		
	ENDPROC

	PROCEDURE diasem
		LPARAMETERS xdFecha,xlShort
		local lcREturn,lcDias,lcDay
		lcDias="Lunes,Martes,Miércoles,Jueves,Viernes,Sábado,Domingo"
		lcReturn=""
		IF !EMPTY(xdfecha)
			lcDay=GETWORDNUM(lcDias,DOW(xdfecha,2),",")
			lcReturn=iif(xlShort,Left(lcDay,3),lcDay)
		ENDIF
		RETURN lcREturn
		
	ENDPROC

	PROCEDURE dosdias
		LPARAMETERS xdFEcha1,xdFEcha2,lecuale
		*******************************************
		* si lecuale=.t. Iguala la fecha vacía
		* si lecuale=.f. La fecha vacía toma un valor
		*			1) 1 de enero de 1992
		*			2) la fecha actual. (date())
		LOCAL ltd
		if lecuale
			if Empty(xdfecha1) AND !empty(xdFecha2)
				xdFecha1=xdFecha2
			endif
			if empty(xdfecha2) AND !empty(xdFecha1)
				xdFEcha2=xdFecha1
			endif
		else
			if empty(xdfecha1)
				xdfecha1=Ctod("01/01/1992")
			endif
			if empty(xdfecha2)
				xdfecha2=date()
			endif
		endif
		if xdFecha2<xdFEcha1
			ldt=xdFecha1
			xdFecha1=xdFEcha2
			xdFecha2=ldt
		endif
		
		return
		
	ENDPROC

	PROCEDURE feriafix		&& Días Feriados Fijos
		LPARAMETERS xnValor,xcTool
		LOCAL nas
		xcTool=""
		nas=ASCAN(this.gaferia,PADL(xnValor,4,"0"))
		IF nas#0
			xcTool=this.gaferia[nas+1]
		ENDIF
		RETURN IIF(nas#0,.t.,.f.)
		
	ENDPROC

	PROCEDURE findemes
		LPARAMETERS xnAno,xnMes
		************************
		* Determina y devuelve el último día de un mes cualquiera 
		* return: date
		*---------------------------------------------------------
		LOCAL lnLast,ldReturn
		if Vartype(xnMes)="C"
			xnMes=val(xnMes)
		endif
		xnMes=EVL(xnMes,MONTH(DATE()))
		if vartype(xnAno)="C"
			xnAno=Val(xnAno)
		ENDIF
		xnAno=EVL(xnAno,YEAR(DATE()))
		RETURN Gomonth( Date( xnAno , xnMes, 1) , 1) - 1
		
	ENDPROC

	PROCEDURE formublok
		lparameters xlFija ,xoForm
		IF VARTYPE(xoForm)="O"
			with xoForm
				.MaxWidth=iif(xlFija,.Width,-1)
				.MinWidth=iif(xlFija,.Width,-1)
				.MaxHeight=iif(xlFija,.Height,-1)
				.MinHeight=iif(xlFija,.Height,-1)
			ENDWITH
		
		ELSE
			with thisform
				.MaxWidth=iif(xlFija,.Width,-1)
				.MinWidth=iif(xlFija,.Width,-1)
				.MaxHeight=iif(xlFija,.Height,-1)
				.MinHeight=iif(xlFija,.Height,-1)
			ENDWITH
		ENDIF
		
	ENDPROC

	PROCEDURE genferiados
		*PROCEDURE VFERIADOS
		* Generando Tabla: FERIADOS
		LOCAL kedia,ketru,kCodefer,cMesano,oPascua
		IF USED("curFeriados")
			SELECT curFeriados
			USE
		ENDIF
		
		CREATE CURSOR curFERIADOS ;
		("CODEFER" C(6),;
		"DIA" D ,;
		"TRUDIA" D,;
		"MESANO" C(18),;
		"DISEMAN" C(14),;
		"MOTIVO" C(40),;
		"FIJO" L,;
		"ACTIVO" L )
		
		SELECT curFeriados
		INDEX ON DTOS(DIA) TAG IFERIADOS
		INDEX ON mesano tag IFERIMES
		
		
		LOCAL i,dndia,dnmes,disano,j,nfop,lunCnv,MarCnv,;
			disano,cDisano,xi
		LOCAL ARRAY gadias(1)
		lshat=.f.
		ldoit=.t.
		
		
		for j=year(date()) to YEAR(DATE())+10
			STore Ctod("") to lunCnv,MarCnv
			disano=j
			cDisano=ltrim(str(disano))
			dimension gadias(18,8)
			* Dia rEAL/mes/Descri/Fijo/Dia Establecido/Clave
			For xi=1 to alen(gadias,1)
				gadias[xi,6]=""
				gadias[xi,7]=1980
				gadias[xi,8]=2099
			next
			
			gadias[1,1]=1
			gadias[1,2]=1
			gadias[1,3]="Feriado Religioso"
			gadias[1,4]=.T.	
			gadias[1,6]="NY"
		
			gadias[2,1]=24
			gadias[2,2]=3
			gadias[2,3]="Día Nacional de la Memoria por la Verdad"	
			gadias[2,4]=.T.	
			GADIAS[2,6]="MM"
			gadias[2,7]=2007
		
			gadias[3,1]=2
			gadias[3,2]=4
			gadias[3,3]="Día del Veterano y Caídos en Malvinas"	
			gadias[3,4]=.T.	
			GADIAS[3,6]="VM"
			
			gadias[4,1]=1
			gadias[4,2]=5
			gadias[4,3]="Día del Trabajador"	
			gadias[4,4]=.T.
			GADIAS[4,6]="DT"	
		
			gadias[5,1]=25
			gadias[5,2]=5
			gadias[5,3]="Aniversario Revolución de Mayo"
			gadias[5,4]=.T.	
			GADIAS[5,6]="RM"
		
			gadias[6,1]=20
			gadias[6,2]=6
			gadias[6,3]="Creación de la Bandera"
			gadias[6,4]=.F.			
			GADIAS[6,6]="MB"
			
			gadias[7,1]=9
			gadias[7,2]=7
			gadias[7,3]="Día de la Independencia"	
			gadias[7,4]=.T.
			GADIAS[7,6]="DI"
			
			gadias[8,1]=17
			gadias[8,2]=8
			gadias[8,3]="Aniversario Muerte de San Martín"	
			gadias[8,4]=.F.
			GADIAS[8,6]="SM"
			
			gadias[9,1]=12
			gadias[9,2]=10
			gadias[9,3]="Día de la Raza"	
			gadias[9,4]=.F.
			GADIAS[9,6]="RZ"
			
			gadias[10,1]=8
			gadias[10,2]=12
			gadias[10,3]="Día de la Virgen"	
			gadias[10,4]=.T.
			GADIAS[10,6]="VM"
			
			gadias[11,1]=25
			gadias[11,2]=12
			gadias[11,3]="Navidad"	
			gadias[11,4]=.T.
			GADIAS[11,6]="NT"
			
		
		
			gadias[12,1]=1
			gadias[12,2]=13	
			gadias[12,3]="Domingo de Pascua"
			gadias[12,4]=.F.
			GADIAS[12,6]="SD"
		
			gadias[13,1]=1
			gadias[13,2]=13	
			gadias[13,3]="Viernes Santo"
			gadias[13,4]=.F.
			GADIAS[13,6]="VS"
		
			gadias[14,1]=1
			gadias[14,2]=3	
			gadias[14,3]="Lunes de Carnaval"
			gadias[14,4]=.F.
			GADIAS[14,6]="LC"
			gadias[14,7]=2011
			
			gadias[15,1]=1
			gadias[15,2]=3	
			gadias[15,3]="Martes de Carnaval"
			gadias[15,4]=.F.
			GADIAS[15,6]="MC"
			gadias[15,7]=2011
			
			gadias[16,1]=20
			gadias[16,2]=11	
			gadias[16,3]="Día de la Soberanía Nacional"
			gadias[16,4]=.F.		
			GADIAS[16,6]="SB"
			gadias[16,7]=2010
		
			gadias[17,1]=1
			gadias[17,2]=1	
			gadias[17,3]="Feriado Turístico 1"
			gadias[17,4]=.F.
			GADIAS[17,6]="T1"
			gadias[17,7]=2011
		
			
			gadias[18,1]=1
			gadias[18,2]=1	
			gadias[18,3]="Feriado Turístico 2"
			gadias[18,4]=.F.		
			GADIAS[18,6]="T2"
			gadias[18,7]=2011
		
			for xi=1 to alen(gadias,1)
				gadias[xi,5]=gadias[xi,1]
			next
		
		
		*	gadias[12,2]=13
			
			for i=1 to alen(gadias,1)
		
				if !gadias[i,4]
					dndia=gadias[i,1]
					dnmes=gadias[i,2]
					CLAVE=GADIAS[I,6]
					do case
						CASE clave=="SD"
							oPascua=This.pascuale(disano)
							gadias[i,1]=DAY(oPascua.pascua)
							gadias[i,2]=MONTH(oPascua.pascua)
							gadias[i,5]=DAY(oPascua.pascua)
		
							gadias[i+1,1]=DAY(oPascua.viernes)
							gadias[i+1,2]=MONTH(oPascua.viernes)
							gadias[i+1,5]=DAY(oPascua.viernes)					
							
							gadias[i+2,1]=DAY(oPascua.lunescar)
							gadias[i+2,2]=MONTH(oPascua.lunescar)
							gadias[i+2,5]=DAY(oPascua.lunescar)		
							
							gadias[i+3,1]=DAY(oPascua.martescar)
							gadias[i+3,2]=MONTH(oPascua.martescar)
							gadias[i+3,5]=DAY(oPascua.martescar)
							
						CASE INLIST(clave,"VS","LC","MC")									
		
		
						CASE CLAVE=="MB"
							* Ley 24445
							IF DISANO<2011
								fodia=This.MotherDay(2,3,dnMes,disano)
								gadias[i,1]=day(fodia)
							ENDIF
							* Ley 24445
						CASE CLAVE=="SM"
		*				case dndia=17 AND dnmes=8
							fodia=This.MotherDay(2,3,dnMes,disano)
							gadias[i,1]=day(fodia)			
						CASE CLAVE=="RZ"
		*				case dndia=12 AND dnmes=10
							if disano<2011
		
								dafe=DATE(disano,dnMes,dnDia)
								ndow=dow(dafe)
						
								do case
									case ndow=2
										Festeja=dafe
									case between(ndow,3,4)
										ndidow=ndow-2
										Festeja=dafe-nDidow
									other
										nDidow=nDow-2
										Festeja=dafe-nDidow+7
								endcase
								gadias[i,1]=DAY(Festeja)
							else
								fodia=This.MotherDay(2,2,dnMes,disano)
								gadias[i,1]=day(fodia)					
							endif
						CASE CLAVE=="SB"
							do case
								case disano<2010
									gadias[i,1]=20
								case disano=2010
									gadias[i,1]=22
								other
									fodia=This.MotherDay(2,4,dnMes,disano)
									gadias[i,1]=day(fodia)
							endcase
						CASE CLAVE=="T1"
							DO CASE
								CASE DISANO=2011
									gadias[i,1]=25
									gadias[i,2]=3
									gadias[i,5]=25
								CASE DISANO=2012
									gadias[i,1]=30
									gadias[i,2]=4
									gadias[i,5]=30
								CASE DISANO=2013
									gadias[i,1]=1
									gadias[i,2]=4
									gadias[i,5]=1
									
								CASE DISANO=2014
									gadias[i,1]=2
									gadias[i,2]=5
									gadias[i,5]=2
																
								CASE DISANO=2015
									gadias[i,1]=23
									gadias[i,2]=3
									gadias[i,5]=23
								
								CASE DISANO=2016
									gadias[i,1]=8
									gadias[i,2]=7
									gadias[i,5]=8						
								OTHERWISE
								
							
							ENDCASE
					
						CASE CLAVE=="T2"
							DO CASE
								CASE DISANO=2011
									gadias[i,1]=9
									gadias[i,2]=12
									gadias[i,5]=9
								CASE DISANO=2012
									gadias[i,1]=21
									gadias[i,2]=6
									gadias[i,5]=21
								CASE DISANO=2013
									gadias[i,1]=21
									gadias[i,2]=6
									gadias[i,5]=21
									
								CASE DISANO=2014
									gadias[i,1]=26
									gadias[i,2]=12
									gadias[i,5]=26
									
								CASE DISANO=2015
									gadias[i,1]=7
									gadias[i,2]=12
									gadias[i,5]=7
									
								CASE DISANO=2016
									gadias[i,1]=9
									gadias[i,2]=12
									gadias[i,5]=9																					
								OTHER
							
							ENDCASE				
		
								
					endcase
				endif
			next
			
		
		*	SELECT curFeriados
			for i=1 to alen(gadias,1)
				if between(disano,gadias[i,7],gadias[i,8])
					kedia=DATE(disano,gadias[i,2],gadias[i,1])
					ketru=DATE(disano,gadias[i,2],gadias[i,5])
					kcodefer=cDisano+padl(transform(i),2,"0")
		
					cMesano=cDisano+":"+PADL(TRANSFORM(gadias[i,2]),2,"0");
						+" "+this.gNombreMes(gadias[i,2],.F.,.t.);
						+PADL(TRANSFORM(gadias[i,1]),2,"0")
						
					INSERT INTO curFeriados (DIA,MOTIVO,FIJO,TRUDIA,MESANO,;
						DISEMAN,CODEFER) ;
						VALUES (keDia,gadias[i,3],gadias[i,4],ketru,cMesano,;
							this.diasem(kedia),kCodefer)
							
		
				endif
			next
		
		NEXT
		
		RETURN "curFeriados"
		
		*!*					locate for trim(codefer)==kCodefer
		*!*					if !found()
		*!*						append blank
		*!*					endif
		*!*					if rlock()
		*!*						replace dia with kedia,;
		*!*							motivo with gadias[i,3],;
		*!*							fijo with gadias[i,4],;
		*!*							trudIA with KETRU,;
		*!*							MESANO WITH cMesano,;
		*!*							DISEMAN WITH Diasem(kedia,.T.),;
		*!*							CODEFER WITH KCODEFER
		*!*						unlock
		*!*					endif
	ENDPROC

	PROCEDURE getfopen
		LPARAMETERS xcFile,xnHandler,xlNotVerb,xnPrivileg,xlOpenEmpty
		**************************************************************
		*!*	Objeto: abrir un archivo con FOPEN()
		*!*	xcFile:    	Ruta y Nombre de archivo completo que se intenta abrir
		*!*				Se puede pasar como xcfile+"<eof/>" 
		*!*				para que quede en EOF()
		*!*	xnHandler: @ Handler pasado por referencia
		*!*	xlNotVerb: suprime comentarios si es .t.
		*!*	xnPrivileg, may be:
		*!*		0 Read Only Buffer
		*!*	 	1 Write ONly Buffer
		*!*	 	2 Read Write Buffer
		*!*	 	10 Read Only No Buffer
		*!*	 	11 Write ONly No Buffer
		*!*	 	12 Read Write No Buffer
		*!*	xlOpenEmpty: Valida la apertura de un archivo vacío
		*!* --------------------------------------------------------------
		*!*	IF !This.GetFopen(addbs(lcRoot)+"archivo.txt",@nfop,.F.,12)
		*!*		RETURN
		*!*	ENDIF
		*!* --------------------------------------------------------------
		
		local lRet,gnEnd,gnTop,nat,lcTag
		lREt=.t.
		STORE "" TO lcTag
		IF EMPTY(xcfile)
			IF !xlNotVerb
				MESSAGEBOX("Nombre de archivo vacío",0,"GetFopen Message")
			ENDIF
			RETURN .F.
		ENDIF
		nat=AT("<",xcFile)
		IF nat > 0
			lcTag=LOWER(TRIM(SUBSTR(xcFile,nat)))
			xcFile=LEFT(xcfile,nat-1)
		ENDIF
		
		IF !file(xcFile)
			if !xlNotVerb
				MESSAGEBOX("El archivo &xcFile no existe",0,"GetFopen Message")
			endif
			RETURN .F.
		endif
		if vartype(xnPrivileg)#"N"
			xnPrivileg=0
		ENDIF
		IF !INLIST(xnPrivileg,0,1,2,10,11,12)
			xnPrivileg=12
		ENDIF
		
		xnHandler=fopen(xcFile,xnPrivileg)
		if xnHandler=-1
			if !xlNotVerb
				MESSAGEBOX("El archivo &xcFile no pudo abrirse",0,"GetFopen Message")
			ENDIF
			RETURN .F.
		ENDIF
		gnEnd=Fseek(xnHandler,0,2)
		IF EMPTY(lcTag) OR lcTag#"<eof/>"
			gntop=Fseek(xnHandler,0)	
		ENDIF
		
		IF !xlOpenEmpty AND gnEnd<=0
			if !xlnotVerb
				MESSAGEBOX("El archivo &xcFile no tiene contenido",0,"GetFopen Message")
			endif
			FCLOSE(xnHandler)
			lRet=.f.
		ENDIF
		
		RETURN lret
		
	ENDPROC

	PROCEDURE getmanak
		LPARAMETERS xoForm,xnTop,xnLeft,xcScript,xnAno,xnMes,xnDia
		IF VARTYPE(xntop)#"N" OR EMPTY(xnTop)
			xnTop=3
		ENDIF
		IF VARTYPE(xnLeft)#"N" OR EMPTY(xnleft)
			xnLeft=3
		ENDIF
		IF VARTYPE(xcScript)#"C"
			xcScript=""
		ENDIF
		
		IF VARTYPE(xnAno)#"N" OR EMPTY(xnAno)
			xnAno=YEAR(DATE())
		ENDIF
		IF VARTYPE(xnMes)#"N" OR EMPTY(xnMes)
			xnMes=MONTH(DATE())
		ENDIF
		IF VARTYPE(xnDia)#"N" OR EMPTY(xnDia)
			xnDia=DAY(DATE())
		ENDIF
		
		IF !USED("curFeriados")
			this.genferiados()
		ENDIF
		
			
		LOCAL lnAno,lnMes,lnPeri,nTop,nLeft,nVert,nHoriz,nwid,nv,nh,;
			lngtop,lngLeft,lcRoot,ocontrol,objin,;
			objCnt,lcname
		
		if !pemstatus(_screen,"Fechasel",5)
			Addproperty(_screen,"FechaSel",null)
		endif
		
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		
		xoform.LockScreen=.t.
		IF !PEMSTATUS(xoform,"gaCont",5)
			ADDPROPERTY(xoForm,"gaCont[1,3]","")
		ENDIF
		
		
		lnAno=xnAno
		lnMes=xnMes
		lnPeri=xnAno*100+lnMes
		SYS(2002)
		STORE xnTop TO nTop,lnGtop
		STORE xnLeft TO nLeft,lnGleft
		STORE .f. TO lSalto
		STORE 0 TO nWid
		
		lnCount=0
		FOR EACH ocontrol IN xoform.controls
			IF oControl.Class="Cntfrm_manak"
				lnCount=lncount+1
			ENDIF
		ENDFOR
		lnCount=lnCount+1
		lcName="cnt_Mk"+TRANSFORM(lnCount)
		
		xoform.NewObject(lcName,"cntfrm_manak",lcRoot,"",lnAno,lnMes)
		WITH xoform
			DIMENSION .gacont[lnCount,3]
			.Gacont[lnCount,1]=This.gNombreMes(lnMes,.t.,.f.)+" "+LTRIM(STR(lnAno))
			.Gacont[lnCount,2]=lnAno*100+lnMes
			.gacont[lnCount,3]=lcName
		ENDWITH
		objCnt=xoform.&lcName.
		WITH objCnt
			nWid=.Width
			.Top=nTop
			.Left=nLeft
			.visible=.t.
		ENDWITH
		xoForm.NewObject("funsombra1","funsombra",Addbs(_Screen.Classdir)+"mzmanak","",.t.)
		xoForm.funsombra1.getBind(objCnt,.t.)
		xoForm.ShowTips=.t.
		xoform.LockScreen= .F.
		
		nas=ASCAN(xoform.gacont,lnPeri)
		lcCont=IIF(nas#0,xoform.gacont(nas+1),"cnt_Mk1")
		IF PEMSTATUS(xoform,lcCont,5)
			lobj=xoform.&lcCont
			WITH lobj
				*.Dia=DAY(DATE())
				.dia=xndia
				.gmes(lobj.ano,lobj.mes,.t.)
			ENDWITH
		ENDIF
		IF UPPER(LEFT(xcScript,LEN("LPARAMETERS")))#"LPARAMETERS"
			xcScript="LPARAMETERS poForm"+CHR(13)+xcSCript
		ENDIF
		
		objCnt.Script=xcScript
		RETURN objCnt
		
	ENDPROC

	PROCEDURE getvaltag
		LPARAMETERS xcTag,xlReturnObj
		**************************************
		* PROCEDURE getValTag(xcTag,xlReturnObj)
		**************************************
		* Etiquetas calificadas ( <NOMBRE|N|1250.12/>  )
		*-----------------------------------------------
		* Si xlREturnObj=.F. (Default)
		* 	Devuelve el valor de una etiqueta
		*	lcTag="<ESTADO|L|.T./>
		*	? GetValTag(lcTag)	&& muestra .T.
		*
		* Si xlReturnObj= .T.
		*	Devuelve la referencia a un objeto "empty"
		*	con tres propiedades: Tag, Value y Type
		*
		*	lcTag="<IMPORTE|N|12726.15/>
		*	obj=GetValTAg(LcTag,.t.)
		*	if !isnull(obj)
		*		? obj.value	&& devuelve 12726.15
		*		? obj.Tag	&& devuelve "IMPORTE"
		*		? Obj.type	&& devuelve "N"
		*		obj=null
		*	ENDIF
		*-----------------------------------------------------
		* Etiquetas cerradas simples
		*-----------------------------------------------------
		* lcTag="<ANIMAL=PERRO/>
		* ? GetvalTAg(lcTag)	&& muestra "PERRO"
		*
		* 	obj=GetValTag(lcTag,.t.)
		*	IF !isnull(obj)
		*		? Obj.TAg	&& muestra "ANIMAL"
		*		? obj.Value	&& muestra "PERRO"
		*		? obj.type	&& siempre muestra "C"
		*	ENDIF
		*-------------------------------------------------------
		* Rutina de exploración:
		*	LOCAL obj,fcr,nHand,lnResp
		*	FCR=ADDBS(FullPath(""))+"formula.txt"
		*	nhand=-1
		*	IF !This.GetFopen(fcr,@nhand,.f.,12)
		*		RETURN
		*	ENDIF
		*	DO WHILE !FEOF(nhand)
		*		lcTag=FGETS(nhand,2048)
		*		DO case
		*			CASE AT("|S|=",UPPER(lcTag))#0	&& ExecScrip()
		*				=GetValTAg(lcTag)
		
		*			CASE AT("#|=",lcTAg)#0			&& Define la tag como variable de paso y le asigna el valor
		*				obj=GetValTAg(lcTAg,.t.)
		*				IF !ISNULL(obj)
		*					lcEtiq=obj.Tag
		*					&lcEtiq=obj.Value
		*					obj=null
		*				ENDIF
		*
		*			OTHERWISE
		*		
		*				lnResp=GetValtag(lcTag)		&& Asigna a lnResp el valor contenido de la tag (puede ser |E|)
		*				
		*		ENDCASE
		*	
		*	ENDDO
		*	=FCLOSE(nhand)
		*	
		******************************************************
		
		LOCAL lcLast,lcREs,lnLines,nPart,lcVari,lctype,;
			lxReturn,objReturn,lcTryValor
		
		IF VARTYPE(xctag)#"C" OR EMPTY(xcTag)
			RETURN IIF(xlREturnObj,null,"")
		ENDIF
		LOCAL ARRAY gaTags(1),gaTypes(1)
		xcTAg=ALLTRIM(xcTag)
		xcTAg=ALLTRIM(xctag)
		* Tag inválida
		IF LEFT(xcTag,1)#"<" OR ;
				AT("=",xcTAg)=0 OR ;
				RIGHT(xcTag,1)#">"
			RETURN IIF(xlREturnObj,null,"")
		ENDIF
		lxREturn=""
		lcType="C"
		
		xcTag=ALLTRIM(xcTag)
		lcLast=IIF(RIGHT(xcTag,2)=="/>","/>",RIGHT(xcTag,1))
		lcRes=STREXTRACT(xcTag,"<",lcLast)
		
		IF AT("|=",lcRes)#0
			lnlines=ALINES(gaTags,lcRes,1+2,"|=")
			IF lnLines>0
				gaTAgs[1]=gaTags[1]+"|"
			ENDIF
		ELSE
			lnLines=ALINES(gatags,lcRes,1+2,"=")
		ENDIF
		*lcVari=gatags[1]
		IF lnLines>1
			lcTryValor=""
			FOR i=2 TO lnLines
				lcTryValor=lcTryValor+gaTags[i]
			NEXT
			IF AT("#|",gatags[1])#0
				xlREturnObj=.t.
				gaTAgs[1]=STRTRAN(gaTAgs[1],"#|","|")
			ENDIF
			lcVari=gatags[1]
			lcTryValor=gatags[2]
			nat=AT("|",gatags[1])
			IF nAt=LEN(gatags[1])-IIF(RIGHT(gatags[1],1)="|",2,1)
				nPart=ALINES(gatypes,gatags[1],5,"|")
				lcVari=gatypes[1]
				lcType=UPPER(gatypes[2])
				DO case
					CASE lcType$"NI"
						lxReturn=VAL(lcTryValor)
					CASE lcType="L"
						lxReturn=IIF(AT("T",lcTryValor)#0,.t.,.f.)
					
					CASE LCTYPE="D"
						lxReturn=CTOD(lcTryValor)
					
					CASE LCTYPE="T"
						lxReturn=CTOT(lcTryValor)
					CASE lctype="E"
						lxReturn=EVALUATE(lcTRyValor)
					CASE lcType="S"
						lcTryValor=CHRTRAN(lcTryValor,CHR(10),"")
						lcTryValor=CHRTRAN(lcTRyValor,CHR(28),CHR(13))
						lxReturn = EXECSCRIPT(lcTryValor)
					CASE lctype="X"
						lxREturn=null
					CASE lcType="O"
						lxReturn=null
					OTHERWISE
						lxReturn=lcTRyValor
				ENDCASE
			ELSE
				lxReturn = lcTryValor		
			ENDIF
		ENDIF
		IF xlREturnObj
			objReturn=CREATEOBJECT("empty")
			ADDPROPERTY(objReturn,"Tag",lcVari)
			ADDPROPERTY(objReturn,"Value",lxREturn)
			ADDPROPERTY(objReturn,"Type",lctype)
		ENDIF
		RETURN IIF(xlReturnObj,ObjReturn,lxREturn)
		
	ENDPROC

	PROCEDURE gnombremes
		LPARAMETERS xnMes,xlProper,xlShort
		LOCAL lcVar,lcMes,lcMeses,lcREturn
		lcVar=VARTYPE(xnMes)
		DO case
			CASE m.lcVar="L"
				xnMes=MONTH(DATE())
			CASE m.lcVar="C"
				xnMes=VAL(xnMes)
			CASE m.lcVar$"DT"
				xnMes=MONTH(xnmes)
		ENDCASE
		IF EMPTY(xnMes)
			RETURN ""
		ENDIF
		lcMeses="ENERO,FEBRERO,MARZO,ABRIL,MAYO,JUNIO,";
			+"JULIO,AGOSTO,SEPTIEMBRE,OCTUBRE,NOVIEMBRE,DICIEMBRE"
		lcReturn=IIF(xlProper,PROPER(GETWORDNUM(lcMeses,xnMes,",")),GETWORDNUM(lcMeses,xnMes,","))
		RETURN IIF(xlShort,LEFT(lcReturn,3),lcReturn)
		
	ENDPROC

	PROCEDURE gstandar
		lparameters cObjWid,cObjHei,xlCmg1,lAyuda,xgnAddHei,xgnDespla,xlSemaf
		
		*Thisform.FunRaya1.gStandar("ShapeWidth","ShapeHeight,lCmg1[cObjeto],LAyuda)
		*cObjWid="Cnt1<Left=3>"
		local gnAdd,lcLeft,nAlterLeft,nresp,oobjWid,oObjHei,oObjCmg,lnREst,lcRoot
		
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		nAlterLeft=0
		
		cObjWid=UPPER(ALLTRIM(cObjWid))
		
		
		nat=AT("<LEFT",cObjwid)
		IF nat#0
			lcLeft=SUBSTR(cObjWid,nat)
			lcLeft=STREXTRACT(lcleft,"<",">")
			cObjWid=substr(cObjWid,1,nat-1)
			nresp=ALINES(galeft,lcLeft,1,"=")
			IF nresp=2
				nAlterLeft=VAL(galeft[2])
			ENDIF
		ENDIF
		
		
		
		if Vartype(cObjHei)#"C" OR empty(cObjHei)
			cObjHei=cObjWid
		endif
		
		cobCmg="Cmg1"
		kevar=Vartype(xlCmg1)
		if kevar="C"
			cObCmg=xlCmg1
			lCmg1=!empty(cObCmg)
		else
			lCmg1=xlCmg1
		endif
		if vartype(xgnAddHei)#"N"
			xgnAddHei=0
		endif
		if vartype(xgnDespla)#"N"
			xgnDespla=0
		ENDIF
		oobjWid=Thisform.&cObjWid
		oObjHei=Thisform.&cObjHei
		oObjCmg=IIF(lCmg1,thisform.&cObCmg,null)
		
		
		gnAdd=iif(lcmg1,42,32)+xgnAddHei
		this.formublok(.f.)
		lnREst=0
		with thisform
			IF .TitleBar=0 AND .BorderStyle=0
				lnREst=0
			ENDIF
			IF nAlterLeft=0
				.Width=oObjWid.left*2+oObjWid.width-lnRest
			ELSE
				.Width=oObjWid.left + oObjWid.Width+nAlterLeft - lnRest
			ENDIF
			.Height=oObjHei.top+oObjHei.Height+gnAdd
			if lCmg1
				oObjCmg.Top=.Height-oObjCmg.Height-6
				oObjCmg.Left=this.ThCentrar(.Width,oObjCmg.Width)+xgnDespla
			endif
			if lAyuda
				.CmAyuda1.top=.Height-24
				.CmAyuda1.Left=3
			endif
			.CmCerrar1.top=.Height-28
			.CmCerrar1.Left=.Width-28-lnRest
		ENDWITH
		IF xlSemaf
			IF !PEMSTATUS(thisform,"CntSemaf100",5)
				thisform.NewObject("CntSemaf100","Semaf100",lcRoot)
			ENDIF
			WITH thisform
				.CntSemaf100.top=.Cmg1.top+4
				.CntSemaf100.left=.Cmg1.left-.CntSemaf100.width-3
				.CntSemaf100.visible=.t.
			endwith
		endif
		This.FormuBlok(.t.)
	ENDPROC

	PROCEDURE Init
		LPARAMETERS xlEarVersion
		DIMENSION this.gaferia(8,2)
		WITH this
			.GaFeria[1,1]="0101"
			.GaFeria[2,1]="0324"
			.GaFeria[3,1]="0402"
			.GaFeria[4,1]="0501"
			.GaFeria[5,1]="0525"
			.GaFeria[6,1]="0709"
			.GaFeria[7,1]="1208"
			.GaFeria[8,1]="1225"
		
			.GaFeria[1,2]=[Feriado Religioso]
			.GaFeria[2,2]=[Día Nacional de la Memoria por la Verdad]
			.GaFeria[3,2]=[Día del Veterano y Caídos en Malvinas]
			.GaFeria[4,2]=[Día del Trabajador]
			.GaFeria[5,2]=[Aniversario Revolución de Mayo]
			.GaFeria[6,2]=[Día de la Independencia]
			.GaFeria[7,2]=[Día de la Virgen]
			.GaFeria[8,2]=[Navidad]
			.objfocus=null
		
		ENDWITH
		IF !xlEarVersion
			thisform.Addproperty("ObjFocus",Null)
		ENDIF
		
	ENDPROC

	PROCEDURE motherday
		LPARAMETERS xnSerieDia,xnApari,xnMes,xnAno
		*************************************
		* xnSerieDia 1234567
		*		     DLMMJVS
		* xnApari 1 a 4, Ordinal	Número de Aparcición
		* La aparición 5 de un día en el almanaque es excepcional
		* Devuelve la fecha correspondiente al número de aparición
		* del día indicado en xnSerieDia
		*************************************************************
		LOCAL fudm,nudm,nDomingo,kkDiasem,xdFecha,n_ord,mi_
		fudm=This.findemes(xnAno,xnMes)
		nudm=day(fudm)
		Store 0 to nSabado,nDomingo,n_Ord
		xdFecha=Ctod("")
		For mi_=1 to nudm
			xdFecha=DATE(m.xnAno,m.xnMes,m.mi_)
			if Dow(xdFecha)=m.xnSerieDia
				n_Ord=m.n_Ord+1
				if n_Ord=m.xnApari
					exit
				endif
			endif
		next
		REturn xdFecha
		
	ENDPROC

	PROCEDURE pascuale		&& Determina el domingo de pascua de un año.
		LPARAMETERS xnAno
		*<Propósito>
		*!*	Determinar el domingo de Pascua de un año cualquiera
		*!*	entre 1600 y 2199.
		*!*	Se determinan también los feriados de Carnaval,
		*!*	Jueves y Viernes Santo
		*!*	Devuelve un objeto (clase Empty) con los valores obtenidos
		*!*	Si el año no es admitido, devuelve null
		*</Propósito>
		
		*<ValidParam>
		IF VARTYPE(xnAno)="C"
			xnAno=VAL(xnAno)
		ENDIF
		IF VARTYPE(xnAno)#"N"
			xnAno=YEAR(DATE())
		ENDIF
		xnAno=EVL(xnAno,YEAR(DATE()))
		*</ValidParam>
		
		*<LocalDef>
		LOCAL a,b,c,d,e,M,N,sDomine,objEmpty,ldCarnaval
		sDomine=CTOD("")
		*</LocalDef>
		
		*<Constant>
		DO case
			CASE BETWEEN(xnAno,1600,1699)
				M=22
				N=2
			CASE BETWEEN(xnAno,1700,1799)
				M=23
				N=3
			CASE BETWEEN(xnAno,1800,1899)
				M=23
				N=4
			CASE BETWEEN(xnano,1900,2099)
				M=24
				N=5	
			CASE BETWEEN(xnAno,2100,2199)
				M=24
				N=6
			OTHERWISE 
				RETURN null
		ENDCASE
		*</Constant>
		
		*<CalcModul>
		a=MOD(xnAno,19)
		b=MOD(xnAno,4)
		c=MOD(xnAno,7)
		d=MOD( 19*a + M , 30)
		e=MOD( 2*b + 4*c + 6*d + N , 7)
		*</CalcModul>
		
		*<DomingoPascual>
		IF (d + e) < 10
			sDomine=DATE(xnAno, 3, d + e + 22)
		ELSE
			sDomine=DATE(xnAno, 4, d + e - 9)
		ENDIF
		DO case
			CASE sDomine=DATE(xnAno,4,26)
				sDomine=sDomine - 7
			CASE sDomine=DATE(xnAno,4,25) AND d=28 ;
				AND e=6 AND a>10
				sDomine=sDomine-7
		ENDCASE
		*</DomingoPascual>
		
		*<Carnevale>
		ldCarnaval=sDomine-42
		do while .t.
			if dow(ldCarnaval,2)=1
				exit
			endif
			ldCarnaval=ldCarnaval-1
		ENDDO
		*</Carnevale>
		
		*<ReturnObject>
		objEmpty=NEWOBJECT("Empty")
		ADDPROPERTY(objEmpty,"PASCUA",sDomine)
		ADDPROPERTY(objEmpty,"VIERNES",sDomine-2)
		ADDPROPERTY(objEmpty,"JUEVES",sDomine-3)
		ADDPROPERTY(objEmpty,"LUNESCAR",ldCarnaval)
		ADDPROPERTY(objEmpty,"MARTESCAR",ldCarnaval+1)
		*</ReturnObject>
		RETURN objEmpty
		
	ENDPROC

	PROCEDURE putraya
		LPARAMETERS xObjeto
		LOCAL lntop,lnLeft,lnWid,lnHei,lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		IF PCOUNT()=0
			thisform.objfocus=Null
			Thisform.imr2.visible=.f.
		   RETURN 
		ENDIF
		thisform.objfocus=xObjeto
		lnTop=OBJTOCLIENT(xObjeto,1)
		lnLeft=OBJTOCLIENT(xObjeto,2)
		lnWid=OBJTOCLIENT(xObjeto,3)
		lnHei=OBJTOCLIENT(xObjeto,4)
		
		IF !PEMSTATUS(thisform,"imr2",5)
			thisform.NewObject("IMR2","Imaraya",lcRoot)
		ENDIF
		With thisform.imr2
			.visible=.t.
			.left=lnLeft+this.ThCentrar(lnwid,.width)
			.top=lnTop+lnHei
		ENDWITH
	ENDPROC

	PROCEDURE puttag
		LPARAMETERS xcClave,xcValor,xnLevel,xcForceType,xlNotype,xcSep1,xcSep2
		****************************************************************************
		* PROCEDURE This.This.PutTag(xcClave,xcValor,xnLevel,xcForceType,xlNotype,xcSep1,xcSep2)
		****************************************************************************
		* Genera una Tag Cerrada
		*!*		xcClave:		Clave de etiqueta
		*!*		xcValor:		Valor de la etiqueta
		*!*		xnLevel:		Desplazamiento de escritura (REPLICATE(CHR(9),xnLevel)
		*!*		xcForceType:	Tipo Forzado (I,E,S) cuando se necesita un comportamiento especial
		*!*		xlNoType:		Etiqueta no calificada (cerrada normal)
		*!*		xcSep1:			Separador de apertura	("<" default)
		*!*		xcSep2:			Separador de cierre		("/>" default)
		*-----------------------------------------------------------------------------------------
		* xlNotype=.F. (Default)
		* <NOMBRE|N|1250.12/> (tipo numérico)
		* <DIA|D|25/12/2013/> (Tipo date)
		* <RESOLVE|E|SQRT( lnCateto1**2 + lnCateto2**2 )/>
		* <PROCEDE|S|MESSAGEBOX("Resultado="+LTRIM(STR(lnResp,14,4)))/>
		*---------------------------------------------------------------
		* Los tipos "CNLDT" se autocalifican
		* This.This.PutTag("VALOR",2012) genera: "<VALOR|N|=2012/>"
		* This.This.PutTag("ESTADO",.T.) genera: "<ESTADO|L|.T./>"
		* This.This.PutTag("CUIT","20120482980") genera "<CUIT|C|=2012048298/>"
		* This.This.PutTag("FECHA",17/12/2013")  genera "FECHA|D|=17/12/2013/>"
		*
		*-------------------------------------------------------------------------
		* Definición forzada
		*
		*	Escritura
		*	LOCAL lcform,lcPut
		*	LCFORM=""
		*	TEXT TO LCFORM TEXTMERGE NOSHOW PRETEXT 7
		*	<<This.This.PutTag("LNRESP",0,0,"*N")>>
		*	<<This.This.PutTag("LNCATETO1",12,0,"*N")>>
		*	<<This.This.PutTag("LNCATETO2",20,0,"*N")>>
		*	<<This.This.PutTag("LNRESP","SQRT( lnCateto1**2 + lnCateto2**2 )",0,"*E")>>
		*	<<This.This.PutTag("LNRESP","(lnResp+LnResp**2)/2",0,"*E")>>
		*	<<This.This.PutTag("MESSAGE",[MESSAGEBOX("Resultado="+LTRIM(STR(lnResp,14,4)))],0,"S")>>
		*	ENDTEXT
		*
		*	LcFile=ADDBS(fULLPATH(""))+"Formula.txt"
		*	STRTOFILE(lcForm,lcFile)
		*
		*	Nota: En xcForceType se utiliza "*", pero también se puede utilizar
		*	      cualiquier otro símbolo que no sea una letra
		*	      También se podría escribir a la inversa, "E*" en lugar de "*E"   	
		*
		*-------------------------------------------------------------------------------------
		*	REsultado (Archvivo Formula.txt)
		*	<LNRESP|N#|=0/>						&& define lnREsp=0
		*	<LNCATETO1|N#|=12/>					&& define LnCateto1=12
		*	<LNCATETO2|N#|=20/>					&& define LnCateto2=20
		*	<LNRESP|E#|=SQRT( lnCateto1**2 + lnCateto2**2 )/> 	&& lnResp=Sqrt(ln..."
		*	<LNRESP|E#|=(lnResp+LnResp**2)/2/>			&& lnResp=(lnResp+lnResp**2)/2
		*	<MESSAGE|S|=MESSAGEBOX("Resultado="+LTRIM(STR(lnResp,14,4)))/>
		*
		*	Nota: Al ejecutar, el Messagebox mostrará "Resultado=283.6619"
		*
		*---------------------------------------------------------------
		* Ejemplo para type "S" [ ExecScript() ]
		*	*Generación de la etiquta
		*
		*	LOCAL lcform,lcPut
		*	LCFORM=""
		*	TEXT TO LCFORM NOSHOW PRETEXT 7
		*	USE C:\THEODORE\ALOJA IN 0 EXCLUSIVE
		*	SELECT ALOJA
		*	IF RECCOUNT()>10
		*		GO 10
		*		replace valchar WITH "RGB() FUNCTION"
		*	ENDIF
		*	BROWSE
		*	USE
		*	ENDTEXT
		*
		*	LCPUT="SCRIPT"
		*	LcFile=ADDBS(Fullpath(""))+"ScripTag.txt"
		*	STRTOFILE(This.This.PutTag(lcPut,lcForm,,"S"),lcFile)
		*
		*	*Ejecuta procedimiento
		*	LcFile=ADDBS(FullPath(""))+"ScripTag.txt"
		*	=This.GetValTag(FILETOSTR(lcFile))
		*-----------------------------------------------------
		
		LOCAL lcType,lcPutVal,lcAddComm
		STORE "" TO lcAddComm
		lcType=VARTYPE(xcValor)
		IF VARTYPE(xcForceType)="C" AND !EMPTY(xcForceType) 
			xcForceType=UPPER(ALLTRIM(xcForceType))
			IF LEN(xcForceType)>1
				xcForceType=This.ValidTExt(xcForceType,2)
				lcAddComm="#"
			ENDIF
			IF xcForceType$'CNDTLES'
				lcType=xcForceType
				xlNotype=.F.
				IF lcType="S"
					xcValor=CHRTRAN(xcValor,CHR(10),"")
					xcValor=CHRTRAN(xcValor,CHR(13),CHR(28))
				ENDIF
				
			ENDIF
		ENDIF
		
		
		DO case
			CASE lcType="N"
		
				LcPutVal=ltrim(str(xcValor,20,this.TelDecim(xcValor)))
			CASE LCTYPE="L"
				lcPutVal=IIF(xcValor,".T.",".F.")
			CASE lcType="D"
				lcPutVal=DTOC(xcValor)	
			CASE lcType="T"
				lcPutVal=TTOC(xcValor)
			CASE lcType="X"
				LcPutVal=".null."
			CASE lcType="O"
				lcPutVal="Object Reference"
			OTHERWISE
				LcPutVal=xcValor
		ENDCASE
		
		IF VARTYPE(xcSep1)#"C" OR EMPTY(xcSep1)
			xcSep1="<"
		ENDIF
		IF VARTYPE(xcSep2)#"C" OR EMPTY(xcSep2)
			xcSep2="/>"
		ENDIF
		IF VARTYPE(xnLevel)#"N"
			xnLevel=0
		ENDIF
		lcType=lcType+lcAddComm
		RETURN REPLICATE(CHR(9),xnLevel);
			+xcSep1;
			+ALLTRIM(xcClave);
			+IIF(xlNoType,"","|"+lcType+"|");
			+"=";
			+ALLTRIM(lcPutVal);
			+xcSep2
		
	ENDPROC

	PROCEDURE qualifer2
		LPARAMETERS xDato,xlQuitComa,xcSep
		*************************************
		* Calificador de datos simil Delimited
		* Alternativa que se emplea en conjunto de datos
		* que no se originan en una sola tabla
		* o se componene de variables de memoria.
		LOCAL kvt,vret,qdezim
		IF VARTYPE(xcSep)#"C"
			xcSep=["]
		ENDIF
		
		*lparameters xdato
		* n,i,c,d,l
		kvt=vartype(xDato)
		vret=""
		do case
			case kvt="C"
				
				vret=xcSep+iif(xlQuitComa,alltrim(strtran(xdato,",")),;
					alltrim(xdato))+xcSep
			case kvt="N"
				qDezim=this.teldecim(xDato)
				vret=ltrim(str(xDato,20,qDezim))
			
			case kvt="I"
				vret=ltrim(str(xdato,20,0))
			
			case kvt="D"
				vret=dtoc(xdato)
			case kvt="T"
				vret=ttoc(xdato)
			case kvt="L"
				vret=iif(xdato,".T.",".F.")
			other
			
		endcase
		
		return vret
		
	ENDPROC

	PROCEDURE readcust
		LPARAMETERS xoForm,xnTop,xnLeft
		LOCAL lnHand,LcFile
		lcFile=LOWER(xoForm.name)+".txt"
		lnHand=-1
		xntop=EVL(xnTop,20)
		xnleft=EVL(xnLeft,5)
		IF this.getfopen(lcFile,@lnHand,.t.,0)
			TRY
				LOCAL loExcep as Exception
				DO WHILE !FEOF(lnHand)
					lcGet=FGETS(lnHand,1024)
					obj=this.getvaltag(lcGet,.t.)
					DO case
						CASE obj.tag="LEFT"
							xnleft=obj.value
						CASE OBJ.TAG="TOP"
							xnTop=obj.value
						OTHERWISE
							lcProp=obj.Tag
		
							DO CASE
								CASE LEFT(lcprop,1)="*"
								*	MESSAGEBOX(lcprop+" "+TRANSFORM(obj.value))
									lcprop=CHRTRAN(lcProp,"*","")
									IF PEMSTATUS(xoForm,lcProp,5)
										xoForm.&lcProp..Value=obj.Value
									ENDIF
									
								OTHERWISE
									IF PEMSTATUS(xoForm,lcProp,5)
										xoForm.&lcProp.=obj.Value
									ENDIF
									
							ENDCASE
					ENDCASE
				ENDDO
			CATCH TO loExcep
				loExcep.UserValue=PROGRAM()
				this.showerror(loExcep)
		
			FINALLY
				obj=null
				=FCLOSE(lnHand)	
			ENDTRY
		ENDIF
		WITH xoForm
			.top=xnTop
			.left=xnLeft
		ENDWITH
		
	ENDPROC

	PROCEDURE savecust
		LPARAMETERS xoForm,xoDesVal
		* Acuerdo
		* xoDesval es un objeto "empty" con 1 ArrayProp gaDesVal{}
		* gaDesval[i,1]="NombrePRop"
		* gaDesval[i,2]=VAlorProp
		
		LOCAL lcfile,i
		lcFile=LOWER(xoForm.name)+".txt"
		TRY
			LOCAL loex as Exception
			lnHand=FCREATE(lcFile)
			=FPUTS(lnHand,this.puttag("TOP",xoForm.Top))
			=FPUTS(lnHand,this.puttag("LEFT",xoForm.Left))
			IF VARTYPE(xoDesval)="O"
				FOR i=1 TO ALEN(xoDesval.gadesval,1)
					=FPUTS(lnHand,this.puttag(xoDesval.gadesval[i,1],xoDesval.gadesval[i,2]))
				NEXT
			ENDIF
			
		CATCH TO loEx
			loex.UserValue=PROGRAM()
			this.showerror(loEx)
		FINALLY
			=FCLOSE(lnhand)
			loex=null
			
		ENDTRY
		
	ENDPROC

	PROCEDURE showerror
		LPARAMETERS objExcep
		LOCAL lcMens
		lcMens="Fecha "+TRANSFORM(DATETIME());
			+CHR(13)+"Mensaje: "+objExcep.message;
			+CHR(13)+"ErrorNo: "+TRANSFORM(objExcep.Errorno);
			+CHR(13)+"Llamada: "+objExcep.Uservalue 
		IF VERSION(2)#0
			lcMens=lcMens+CHR(13)+"Línea: "+TRANSFORM(objExcep.lineNo)
		ENDIF
		
		STRTOFILE(lcMens+CHR(13),"ThError.log",1)
		lcMens="Se ha producido un error:"+chr(13)+lcMens
		MESSAGEBOX(lcMens,0,tH_MENSAJE)
	ENDPROC

	PROCEDURE teldecim
		LPARAMETERS xcnNUmero,xnPrecision
		*****************************************
		* Determina la cantidad de decimales de un número.
		* xnPrecision podría ser Entre 10 y 16
		* 16 daría una precisión mayor pero válida para
		* números con alta cantidad de decimales.
		*********************************************
		local i_,LnNumero,lnpNum,cRest,;
			nDecimales,lcTipVar
		if vartype(xnprecision)#"N"
			xnPrecision=10
		endif
		lcTipVar=Vartype(xcnNumero)
		do case
			case lcTipVar="C"
				LnNumero=val(xcnNumero)
			case lcTipVar$'NI'
				LnNumero=xcnNumero
			other
				return 0
		endcase
		if LnNumero=0
			return 0
		endif
		nDecimales=16
		for i_=0 to 16
			lnpNum=Round(LnNumero*10**i_,xnPrecision)
			cRest=lnpNum-Int(lnpNum)
			nDecimales=i_
			if Round(cRest,xnPrecision)=0
				exit
			endif
		next
		return nDecimales
		
	ENDPROC

	PROCEDURE telmedia
		LPARAMETERS dFecha,lOnlyDay,lElimDay,lShortMes
		*****************************************************
		local ndia,nmes,nano,hOYES,lcDias,lcDay,lcReturn
		lcReturn=""
		lcDias="Lunes,Martes,Miércoles,Jueves,Viernes,Sábado,Domingo"
		IF !EMPTY(dfecha)
			lcDay=GETWORDNUM(lcDias,DOW(dfecha,2),",")
			ndia=day(dfecha)
			nmes=month(dfecha)
			nano=year(dfecha)
			if lOnlyday
				lcReturn=lcDay
			else
				if !lElimDay
					lcREturn=lcDay+" "+ltrim(str(ndia))+" de "+this.gNombreMes(nMes,.t.,lShortMes)+" de "+ltrim(str(nano))
				else
					lcReturn=ltrim(str(ndia))+" de "+this.gNombreMes(nMes,.t.,lShortMes)+" de "+ltrim(str(nano))
				endif		
			ENDIF
		ENDIF
		Return lcREturn
		
	ENDPROC

	PROCEDURE thcentrar
		LPARAMETERS wCont , wObje ,xnLeft,xnRight 
		*function thcentrar(wCont , wObje ,xnLeft,xnRight )
		**********************************
		* Permite centrar horizontalmente un objeto en un contenedor
		* wCont = ancho del contenedor (o espacio disponible)
		* wObje = ancho del objeto (o texto) a centrar en el contenedor
		* Devuelve la posicion Left del objeto o texto.
		* xnLeft= Desplazamiento de centrado (a la derecha)
		* xnRight= Desplazamiento de centrado (a la izquierda).
		
		if Vartype(xnLeft)#"N"
			xnleft=0
		endif
		if Vartype(xnright)#"N"
			xnright=0
		endif
		wCont=wCont - (xnLeft+xnRight)
		return xnLeft+ ( Round(wCont/2,0) - Round(wObje/2,0) )
	ENDPROC

ENDDEFINE

DEFINE CLASS funsombra AS custom 
 	*< CLASSDATA: Baseclass="custom" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*m: addshape
		*m: getbind
		*m: rmvshape
		*m: saychange
	*</DefinedPropArrayMethod>

	Name = "funsombra"
	Width = 30
	
	PROCEDURE addshape
		* AddShape Method
		* Bind GotFocus Event
		**********************
		LOCAL ntop,nLeft,nWidth,nHeight,lcName,nEvents,xoObjeto,obj
		nEvents=AEVENTS(gaEvent,0)
		IF nEvents=0
			RETURN
		ENDIF
		xoObjeto=gaEvent[1]
		thisform.previus=xoObjeto.value
		ntop=xoObjeto.top
		nLeft=xoObjeto.left
		nWidth=xoObjeto.width
		nHeight=xoObjeto.Height
		lcName="Shape_"+xoObjeto.name
		IF !PEMSTATUS(xoObjeto.parent,lcName,5)
			xoObjeto.Parent.newobject(lcName,"Shape")
		ENDIF
		Obj=xoObjeto.Parent.&lcName
		WITH obj
			.Top=nTop-2
			.Left=nLeft-2
			.Width=nWidth+4
			.Height=nHeight+4
			.BackStyle=0
			.BorderColor=RGB(0,64,128)
			.Curvature=5
			.Visible=.t.
		ENDWITH
		xoObjeto.zOrder(0)
	ENDPROC

	PROCEDURE getbind
		LPARAMETERS xoObjeto,lOmitUnb
		LOCAL ocontrol,ocont,objPict,opage
		ADDPROPERTY(thisform,"Previus",0)
		DO case
			CASE UPPER(xoObjeto.Baseclass)="FORM"
				IF !lOMitUnb
					UNBINDEVENTS(xoObjeto)
				endif
				FOR EACH oControl IN xoObjeto.Controls
					this.GetBind(oControl,lOmitUnb)	
				ENDFOR
				
				
			CASE UPPER(xoObjeto.Baseclass)="CONTAINER"
				IF !lOmitUnb
					UNBINDEVENTS(xoObjeto)	
				endif
				FOR EACH xoObjeto IN xoObjeto.Controls
					This.getbind(xoObjeto,lOmitUnb)
				ENDFOR		
		
		
			CASE UPPER(xoObjeto.Baseclass)="PAGEFRAME"
				IF !lOmitUnb
					UNBINDEVENTS(xoObjeto)
				endif
		
				FOR EACH OPAGE IN xoObjeto.pages
					IF !lOmitUnb
						UNBINDEVENTS(oPage)
					endif
					
					FOR EACH objPict IN opage.controls
						THIS.GETbind(OBJPICT)
					ENDFOR
					
				ENDFOR
		
		
			CASE UPPER(xoObjeto.baseclass)="IMAGE"
				IF !lOmitUNb
					UNBINDEVENTS(xoObjeto)	
				ENDIF
				
		
			CASE INLIST(UPPER(xoObjeto.BaseClass),"TEXTBOX","EDITBOX","COMBOBOX","LIST","SPINNER")
				WITH xoObjeto
					.specialEffect=1
					.BorderColor=RGB(114,136,141)
				*	.Disabledbackcolor=RGB(242,247,243)
				ENDWITH
				IF !lOmitUnb
					UNBINDEVENTS(xoObjeto)
				ENDIF
				
				BINDEVENT(xoObjeto,"GotFocus",this,"addshape")
				BINDEVENT(xoObjeto,"LostFocus",this,"rmvshape")
				
		
		ENDCASE
	ENDPROC

	PROCEDURE Init
		LPARAMETERS xlNotBind
		IF !xlNotbind
			This.getBind(thisform)
		ENDIF
		
	ENDPROC

	PROCEDURE rmvshape
		* RmvShape Method
		* Bind Lostfocus Event
		LOCAL lcName,nEvents,xoObjeto
		nEvents=AEVENTS(gaEvent,0)
		IF nEvents=0
			RETURN
		ENDIF
		xoObjeto=gaEvent[1]
		
		lcName="Shape_"+xoObjeto.name
		IF PEMSTATUS(xoObjeto.parent,lcName,5)
			xoObjeto.Parent.removeobject(lcName)
		ENDIF
		
	ENDPROC

	PROCEDURE saychange
		LOCAL ntop,nLeft,nWidth,nHeight,lcName,nEvents,xoObjeto,obj
		nEvents=AEVENTS(gaEvent,0)
		IF nEvents=0
			RETURN
		ENDIF
		xoObjeto=gaEvent[1]
		IF xoObjeto.Value#thisform.previus
			MESSAGEBOX("Cambio en "+xoObjeto.name)
		ENDIF
		
	ENDPROC

ENDDEFINE

DEFINE CLASS glab AS label 
 	*< CLASSDATA: Baseclass="label" Timestamp="" Scale="Pixels" Uniqueid="" />

	AutoSize = .T.
	BackStyle = 0
	Caption = "gLabel1"
	FontSize = 8
	Height = 16
	Name = "glab"
	Width = 40

ENDDEFINE

DEFINE CLASS gmarco AS shape 
 	*< CLASSDATA: Baseclass="shape" Timestamp="" Scale="Pixels" Uniqueid="" />

	BackColor = 231,237,234
	BorderColor = 114,136,141
	Height = 21
	Name = "gmarco"
	Width = 100

ENDDEFINE

DEFINE CLASS imaraya AS image 
 	*< CLASSDATA: Baseclass="image" Timestamp="" Scale="Pixels" Uniqueid="" />

	BackStyle = 0
	Height = 4
	Name = "imaraya"
	Picture = ..\graphics\raya.bmp
	Visible = .F.
	Width = 22

ENDDEFINE

DEFINE CLASS pofechoy AS textbox 
 	*< CLASSDATA: Baseclass="textbox" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*m: convoca
		*m: getestado
		*m: gshut
		*p: obmanak		&& Objeto Almanque
		*p: pedido
	*</DefinedPropArrayMethod>

	Alignment = 3
	BorderColor = 114,136,141
	DisabledBackColor = 220,228,224
	DisabledForeColor = 0,0,0
	FontSize = 8
	Format = "D"
	Height = 21
	Name = "pofechoy"
	obmanak = NULL		&& Objeto Almanque
	pedido = .F.
	ReadOnly = .T.
	SpecialEffect = 1
	Value = (CTOD(""))
	Width = 63
	
	PROCEDURE Click
		IF this.ForeColor#RGB(0,0,255)
			RETURN
		ENDIF
		LOCAL lnPeri,lnAno,lnMes,lnDia
		lnPeri=VAL(LEFT(DTOS(this.Value),6))
		lnDia=DAY(this.Value)
		lnAno=YEAR(this.Value)
		lnMes=MONTH(this.value)
		nas=ASCAN(thisform.gacont,lnPeri)
		*lcCont=IIF(nas#0,thisform.gacont(nas+1),"cnt_Mk1")
		IF nas#0
			lcCont=thisform.gaCont(nas+1)
			IF PEMSTATUS(thisform,lcCont,5)
				lobj=thisform.&lcCont
				WITH lobj
					*.Dia=DAY(DATE())
					.dia=Lndia
					.gmes(lobj.ano,lobj.mes,.t.)
				ENDWITH
			ENDIF
		ELSE
		
			thisform.Cnt_Mk1.dia=DAY(DATE())
			Thisform.genmanak(lnAno,lnMes,lndia)
		
		
		ENDIF
		
	ENDPROC

	PROCEDURE convoca
	ENDPROC

	PROCEDURE getestado
		LPARAMETERS poManak
		*MESSAGEBOX("Sucede "+poManak.name)
		LOCAL dFecha
		dfecha=DATE(poManak.ano,poManak.mes,poManak.dia)
		WITH this
			.ToolTipText=IIF(dfecha=this.Value,"","Enfocar el "+DTOC(this.Value))
			.DisabledBackColor=IIF(dfecha=this.Value,RGB(220,228,224),RGB(242,247,243))
			.MousePointer=IIF(dfecha=this.Value,0,15)
			.DisabledForeColor=IIF(dfecha=this.value,RGB(0,0,0), RGB(0,0,255))
			.ForeColor=IIF(dfecha=this.value,RGB(0,0,0), RGB(0,0,255))
		ENDWITH
		
	ENDPROC

	PROCEDURE gshut
	ENDPROC

ENDDEFINE

DEFINE CLASS semaf100 AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="iverde" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="irojo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="iamarillo" UniqueID="" Timestamp="" />

	BackStyle = 0
	BorderWidth = 0
	Height = 19
	Name = "semaf100"
	Width = 21

	ADD OBJECT 'iamarillo' AS image WITH ;
		BorderColor = 114,136,141, ;
		BorderStyle = 1, ;
		Height = 18, ;
		Left = 1, ;
		Name = "iamarillo", ;
		Picture = ..\graphics\yellowball.bmp, ;
		Top = 1, ;
		Visible = .F., ;
		Width = 20
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'irojo' AS image WITH ;
		BorderColor = 114,136,141, ;
		BorderStyle = 1, ;
		Height = 18, ;
		Left = 1, ;
		Name = "irojo", ;
		Picture = ..\graphics\redbrball.bmp, ;
		Top = 1, ;
		Visible = .F., ;
		Width = 20
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'iverde' AS image WITH ;
		BorderColor = 114,136,141, ;
		BorderStyle = 1, ;
		Height = 18, ;
		Left = 1, ;
		Name = "iverde", ;
		Picture = ..\graphics\greenball.bmp, ;
		Top = 1, ;
		Visible = .F., ;
		Width = 20
		*< END OBJECT: BaseClass="image" />
	
	PROCEDURE Init
		WITH THIS
			.height=.iamarillo.Height+1
			.Width=.Iamarillo.Width+1
			.irojo.Visible=.t.
			.iverde.Visible=.f.
			.iamarillo.Visible=.f.
		ENDWITH
		
		
	ENDPROC

ENDDEFINE

DEFINE CLASS shape3d AS shape 
 	*< CLASSDATA: Baseclass="shape" Timestamp="" Scale="Pixels" Uniqueid="" />

	BackColor = 221,226,222
	Height = 30
	Name = "shape3d"
	SpecialEffect = 0
	Width = 100

ENDDEFINE

DEFINE CLASS txfecha AS textbox 
 	*< CLASSDATA: Baseclass="textbox" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*m: convoca
		*m: gshut
		*p: obmanak		&& Objeto Almanque
		*p: pedido
	*</DefinedPropArrayMethod>

	Alignment = 3
	BorderColor = 114,136,141
	DisabledBackColor = 242,247,243
	DisabledForeColor = 0,0,0
	FontSize = 8
	Format = "D"
	Height = 21
	Name = "txfecha"
	obmanak = NULL		&& Objeto Almanque
	pedido = .F.
	SpecialEffect = 1
	Value = (CTOD(""))
	Width = 63
	
	PROCEDURE convoca
		LPARAMETERS xnVal
		local lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		this.pedido=.t.
		LOCAL dfe,nyear,nmes,ndia
		dfe=this.Value
		IF EMPTY(dfe)
			dfe=DATE()
		ENDIF
		IF xnVal=-1
			dfe=GOMONTH(dfe,-1)
		ENDIF
		nyear=YEAR(dfe)
		nmes=MONTH(dfe)
		ndia=DAY(dfe)
		
		this.obmanak=NEWOBJECT("frmManak",lcRoot,"",nYear,nMes,ndia,;
			This,Thisform.WindowType)
		
		
	ENDPROC

	PROCEDURE DblClick
		this.Convoca(0)
		
	ENDPROC

	PROCEDURE gshut
		IF !ISNULL(this.obmanak)
			this.obmanak.release
			this.obmanak=null
		ENDIF
		
	ENDPROC

	PROCEDURE Init
		this.obmanak=null
		BINDEVENT(thisform,"Destroy",this,"gshut")
	ENDPROC

	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		DO case
			CASE nkeycode=-1
				NODEFAULT
				this.convoca(0)
			CASE nKeyCode=43
				NODEFAULT
				this.Convoca(0)
			CASE nKeyCode=45
				NODEFAULT
				this.Convoca(-1)
				
		ENDCASE
	ENDPROC

ENDDEFINE

DEFINE CLASS txfechan AS textbox 
 	*< CLASSDATA: Baseclass="textbox" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*m: convoca
		*m: gshut
		*p: obmanak		&& Objeto Almanque
	*</DefinedPropArrayMethod>

	Alignment = 3
	BorderColor = 114,136,141
	DisabledBackColor = 242,247,243
	DisabledForeColor = 0,0,0
	FontSize = 8
	Format = "D"
	Height = 21
	Name = "txfechan"
	obmanak = NULL		&& Objeto Almanque
	SpecialEffect = 1
	Value = (CTOD(""))
	Width = 63
	
	PROCEDURE convoca
		LPARAMETERS xnVal
		LOCAL dfe,nyear,nmes,lcRoot
		lcRoot=iif(pemstatus(_Screen,"Classdir",5),LOCFILE(ADDBS(_Screen.ClassDir)+"mzmanak.vcx"),"mzmanak")
		dfe=this.Value
		IF EMPTY(dfe)
			dfe=DATE()
		ENDIF
		nyear=YEAR(dfe)
		nmes=MONTH(dfe)
		IF xnVal= -1
			nYear=YEAR(DATE())
			nmes=MONTH(DATE())
		ENDIF
		this.obmanak=NEWOBJECT("frmAnual",lcRoot,"",nYear,nMes,;
			This,Thisform.WindowType)
		
	ENDPROC

	PROCEDURE DblClick
		this.convoca(0)
		
	ENDPROC

	PROCEDURE gshut
		IF !ISNULL(this.obmanak)
			this.obmanak.release
			this.obmanak=null
		ENDIF
		
	ENDPROC

	PROCEDURE Init
		this.obmanak=null
		BINDEVENT(thisform,"Destroy",this,"gshut")
	ENDPROC

	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		DO case
			CASE nkeycode=-1
				NODEFAULT
				this.convoca(0)
			CASE nKeyCode=43
				NODEFAULT
				this.Convoca(0)
			CASE nKeyCode=45
				NODEFAULT
				this.Convoca(-1)
				
		ENDCASE
		
		
	ENDPROC

	PROCEDURE RightClick
		this.convoca(-1)
	ENDPROC

ENDDEFINE

DEFINE CLASS txfechasel AS textbox 
 	*< CLASSDATA: Baseclass="textbox" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*p: obmanak		&& Objeto Almanque
		*p: pedido
	*</DefinedPropArrayMethod>

	Alignment = 3
	BorderColor = 114,136,141
	DisabledBackColor = 242,247,243
	DisabledForeColor = 0,0,0
	FontSize = 8
	Format = "D"
	Height = 21
	Name = "txfechasel"
	obmanak = NULL		&& Objeto Almanque
	pedido = .F.
	SpecialEffect = 1
	Value = (CTOD(""))
	Width = 63
	
	PROCEDURE DblClick
		IF PEMSTATUS(_screen,"fechasel",5)
			this.Value=_screen.fechasel
		ENDIF
		
		
	ENDPROC

	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		DO case
			CASE nKeyCode=43
				IF PEMSTATUS(_screen,"fechasel",5)
					this.Value=_screen.fechasel
				ENDIF
				
				NODEFAULT
				
		ENDCASE
	ENDPROC

ENDDEFINE
